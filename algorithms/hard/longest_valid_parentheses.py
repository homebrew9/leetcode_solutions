class Solution:
    def longestValidParentheses(self, s: str) -> int:
        N = len(s)
        dp = [0] * N
        res = 0
        for i, v in enumerate(s):
            if v == ')':
                if i > 0:
                    if s[i-1] == '(':
                        dp[i] = dp[i-2] + 2
                    else:
                        prev_ind = i - dp[i-1] - 1
                        if prev_ind >= 0 and s[prev_ind] == '(':
                            if prev_ind == 0:
                                dp[i] = dp[i-1] + 2
                            else:
                                dp[i] = dp[i-1] + dp[i - dp[i-1] - 2] + 2
            res = max(res, dp[i])
        #print(dp)
        return res

# Main section
for s in [
            '(()',
            ')()())',
            '',
            '()()()()()',
            '())((())',
            '()(())(',
            '(((())()()())((',
            '(((())()()()(((',
            '(()))())(',
            '(()((())))()()))((())(())))())())))(((((((()()(()())())))))())()(())())(((((((((())()((()(((())(())(',
            '()())()(()()))((()())()))))))()((()(()())()))()))))()(()())))))(((()()()())((())))(())(()()())))))(((())())))(((())()))(()))(((())()((())(()(()))((()())((())(())))()(((((())(()))())())()()(((()()(()(((()))()))(()(()))))()))()()((()()(((()(((((()(())(((()()((((()))))()(((())(()))(((()))()(()()()()()((())))))()(())((())(())((((()()))))(()))())(())))()()(()))())()()))()((((())))()))(((()())()()))))()()(())(())(((())()((()))(()((()()())()()(())((()))))))(())()()))(())()()))))()(()((())()()((()()()((()()((()((())))(((()(()())(((()((()))()((()))()((())())))())(()((())(()()())((()()))()())()()(()()()))(()))())((()(())()((())(((())(()))((()())((()()()))))()))())()))()()))))((())((((()))))((())(((((((()()(())())(()(()(()((()())(())(())))()((()((()))))(()(()(())(((()((())))((()())(((((()((()())))()()(()))(()(()()(())))()())))()))((()())()))()()))()(()((((()()))((()))(()))(()((()))))))(((()((((()())))))()(()()()(()()((())((()))()(())))()(())(()(()()(()()(((((()((()))(((()(()()())(())))))))()))))(',
            #')())(())))(())))))()(())(()((()(((((((()())))))(((())())()((())((()))))((()())))()))((((()((()()(())(()()(()((((()((()()))))))())()((()))()())))(())))())))((()))()())())()(()))((()))))))())))))(((())()())())())()))()(((()()))()())()()))((()))))())((()())(()()))))))())((((()))((())(()()())((((()((())))))))()((()(()())))(()())))))))))((((())((((()()))))(()()(())(()())(())()(((()))(())(()))()((())())(((()))(())())((())(())))()())(()))()((()()))))((())()()))((()()(())(()(()()))(())((()))()))))())()())())()(())()))())))((()(())((()))()()())))))))()()()(())))())()))))))()()())))))(()(())())(())()))())))(()())(()())()()))()(())(()))(()()()(()()()(((()(())((()(())()(())(((()(()))))(()()()())(((()))()))()(()()(())))((()())())))((()()))())))())(()(((()((()(()))))())(())((()))))))()()()(()(((())))((())())))(()((()(()))))()))((()()())()))))(()(()(())((()()()()(())))()())(()())()()((((()))(()()())))))()(()()())((())(())))()(())()(()))))((()(())(((())(((()(()((((((((()())))))()(())(()())((((()()(()(()))))(()(()))()))))((())())((())(()())())()))()()(((((()(((())())((())((())()()(()()))))(((((())()(((((())(((()(()()()))))))(()())()()(()(())))())(()((()(((())(((((())()))()(()))(()(()((())())((())()()()()))()(())((()((()((((((())))))(()()((((((())()(((())(()()()))))((()())(()()(((()))()()()()))(())((()))(()((((())))())(())())))(()))(((()(()))))(()(())())())))()))(()((((()(()((())))))(((()(()))((())))(()(()))))((((()))(()(()(())()((()))(())(((())(()()))())(()(()(()()))()()())((())((())(())()((()((()()))))()))(((((())()())()(((()()())()(()()(())()(((()(((()((((()(()())(())())(()))()(((()))()(()())()(())())()(()(()())))))))()(())(()()(())))()(()())(())())((())))()(((((())((()((())(()()()))())()(()(()(())(()(()()()((())()((()(((()())(())))))()(()()))))(((((())))(()(((())())())(()))()()))(((((()()())))))()()()()()(((((()()())(()(()(()(()))()((())((()(((()(()((())((()(()())))))()()(()()(())())))))))()(()(((())())))(()())())((()))))))(())((())()()()()(()(((()(()())()((())))((()())()))))(()()((()()(()()())(()))(())()((()()((()()))()()())()((())(()))))(())()())()(())(((()(()))())()))(()((()))))()((()(()((())()))(()))(()))())(())()())((()((()(()()))(()))()))((((())()(())))(()(())((((((())()))(()))))(())())((())((()))(())())()))))()()(((()((()()((()))(((((()())())((())())(()((())()(((()))()))))(((((()(())()())())))())((())(()())()(()))(())())((((()))))))))())(())()(()(()(()(((()())()())(()()())()()))(()))))(((((()))((()))((()))(())))))((((()))()(()(())))(()((())(()(())()()()((((()))())()))(()))))())((((())(()(())(())(((())()((()()))((()()))()()(())())(())))))(()(())))))))()()))()()))(()(()(()()(()()))()(((()(()()(((()()((()(())(((())()()()())(())(((())))(((()))(((()))(())(((((((())(()))()))()())((()())()()(()(()(()()()()))())((()()))(()(((((())))())())))()(())))()))(((((()(((())(())()())(((()(()(())()(()(()((((((()())((())()()()(()()()(()(()))(((((((())))((((()(()))))))())()()())))(())((()()()))()))((()())(())()))))()(()()))(())))())((()))())())))(()(())(()(())((((((()(((((((((()((()())())())(())())(()((()(()(()(()()(((((())(())((())((())())()))))()()())(())))()((()(()())((())((())((((())))))()))()()(()(()()()))(()()(()())))(()))))))(((((())))())))(())(((()((())))))()()))()(())))()))()))()()))((())())))(())((()))())))(()()()((())((((()(())())()))()))((())()()))()())()())(()))((((()))()(()()(((()))))()((())(((((()(((((()()))()()(()))())(()((()((()(()()((((()))(())))(((((())((()())()()(()))()((())())))()()(()()))))())(()((())(()))(()()))()(((()((()(()(()))))))(()(()(((()(((((()(()())(()))()())(()((())()(()(((((())((()))))(())((((((((((()(()(()))(()((()()((())())))())(()))))(()(()))())()))(((()(()(()((((()(()))()()))))))))()())(()()))))))(()(()((((()(()))()()))(()(((())))))(((())))((()()(())(())))())(())))()))((((())(((()(())((())(((())()()()()(((((()()())(()))()()())()))((())))()((()(())((((())(()))())(()()())(()))((()()((((()))()()()))((((((((()(((((())(((()))()))))(()))())))))()((()((((())))(((())))))))(()))())(())((((((()((((())()(())(()())(()((()())(())((((()(())))())()())()(((()(())))()))(()(()((()(()((()(((()(()((()))())(((())())((()()()())((())))((((()))))()()()((((())()))(((((()))(()())))(((((())()()()()(()(((()))(())(())(((())()())(())(()(()()(()))()(()((()()((((((())((((()))))()))()(()))()((()())((()())()(((()())))(()())())))))))))((((()(()((((())(()())()))))())(()))()))))())))))()((()())))()))()(()(()((())(()))((())(()((((())()()()()(()))))()()()()(()())))())))((()))()()()())(()()))(())()()()(()))()((()()(()(((((((()(()(()())((()((()(()()))))))))()))())(())(()(()((())))))()()())))((()())())()))(()()))()(())((()())())()((())))))))))(((()())()))()())))()))((()()(((())())())))()()((())()(())))))(())(((()(()()()()()))((())()(((()(((((((()))()))()((())((())(()(())(((()((()(()(()()(((()()()(((())((((()))))())))()((((()((()))((((())())()()))())))(()()()()()(()())(()()((())))((((((())()())))()((()))()()(())()))(((((()))))(()))())(())(((()())(())((()()(((()()((()(()(()()()((()()((())(())()((()))()()(((())()(()((((((()))(((())))((()())))(()))))(())))()))))()()(()))))))()))(()((()())(()())((((())()))))())())())))()()(()))()))(()(())))(((()(((()(()))((())(((((((()(()((()((((()(()())())))(((((()()()()()(())))((())())(())(()))))))))((((()((())()())((((()()))())(())))))((()()())))()))))(()))(()())((((()(((()))(((((()())(((((())(((()((()()()(()(((((())((())))(()))((())(()))()))(((()((()(()())())())())))))))))())))))())()())))()())())((())((((((((())((())(()())((())()((())))))))())()((()))()(()(())))()()(((())()()(()))))))))))()((())()(()(((((())))((()((())()))((()((((()(()()(()()))))((((()()())))()())(()()(((((()()()))))()()())))()()(()(()()(((((()(()(()()()())((((())((())(()((((())((())((()()((((())()())))())()()(()(())())()((()())())()((()(())(()(()())()()((()((()((((())())(()()))(()(())(()(())(())(()()(()(()((()(((())()(((()(()()()())(())())((())(())())(()((()))()((()))())())()()(((((()))())(()))()()()))()()()(())))()))(())()(())))))()(((()()(()()((()(((()(()((()()()()))()(()(((()((())(()()((((((()(()())))())()(())(()())((())))()(()()))))())(()()())()))())(()()))()()()()(()()))((()))()((()))())())))())))))())((()(()((()(())(()())()))()))()()(())(()())((()()(())((()((((()(()))()(((((())()()))(((((()(()())(()())((()()((()()((()))))))))(()()))(())()()())(((()((()(()())(()(())()(()((()))))(((()()()((()()))((()(())((()((((()(()(((()()(((()(())))()(()()(((()((()())()(()((()())((((()(()))())()())(()()((()(()))))))(()())()(())((())))))))((())))(())))))()()((())))()())((((())(((())()())(())))(())(((()(()((())))((((())))()(()(()))((()())((()())()))))((()(()()))))(())(())))())))()()((()))())()(()()(()))))((()(()())()(()()()))(((())())))))((((()(((((()())((()(((()())()))(())()())())))(())))))()()())))()())(((()((())()))()()(()))((((())(())()()()((())()))))(()((())))))()()(((()(((()()))))((((()(())())()((())))()))()())()(((()(()((())()(())))(())(())()()))())(((()())())(())))(()))(()(())))()())))(((())()(()()))()()()))((()()))))))))()(())(((((()()())))(())((()))))(((()(()()(((()()()(()(()))))))))()(())((()()((()(())((())))()(())((())(())))(())()(((())()))((((()()()((()()(())()()()())()))(((((()))))())))())(()())(()())()(((()())((())()()))((()(((()())(()((((()(()((()))()()))()))()(())((()()))()((())(())(()(()()))()))(()))())))()))))))(()()())())())(())((()))((()((()))((())(())((())()))())(()()))(((()(()())(((()((()()))())(()()))()))()))((()))))())))())()()(()((((()()((()()()()))()()))())))(((()(()))))(()()((()(()()((())))))())(())((())()(((((()()(())()))()((())())))(((((()()((()())))))())()()((()))))(())()(()(((()((()((((())))(())(())()(((())()()))()))((())())((()(()))(((())(((()))))))(((((()()(()(()((((()()()(()())())()())((()(((())(()((((()())()()((())()(((((()()()(((())((((()(()((()(((()))))()()()((((((((((((()))()()((((((((())()))((((())()()((()(()(((()))()()())(()(((()())))(()(())()()())()(()((()))()(()))(()(())(())((((())((()(()()))((())))((()))))((((()(()(()))()))())(())())(()))))))())))(())())()))((()()))(((((((()))))((()())(())))(((()()))(())()(((()((()))((())()(()((()(((())((()))))(())()))()))(()((()()))()))(()(()()(((((()))()))())))(((())()))()()((((()(()((()(((())(())()((((()(()())(()())()())))((()((()(()))()((((((()()((()()())(())(())))())(())())(()()))))((()()(()(()(())()))((())(())())(())(())))(())(()(())())(()())(()(()))))))))())))(())))(())))())()()()())()(())()()))(()())))())(()())((()))()((()()))(()()()())()(((()))()(()((())()()()((()(()(((()))(()))))))((((()()((((()))(()))(()())(()))))(()))((()(()(())())())((((()))())))()()(()(())()))()(()((()))(()(()()))())((()))())()()()((()))(())(()))))())(()())))(()((()()()(())())))(()()(((())())())())(()()())()((())(()))()(()))((((()())(()()(()(((()()())())()))))(())(()(())))(((()(((())()())()()(()))))(())())((()()((((()((()))()(()()()(())(()(()(()()((()(((())()))(()())(()))))((())()()())))(())()))(((()))(())(()((()((()))(()))()((())(((()()))()()(()((()))((()(())))()(()())))())())()((((((((())))()()))))(((())()(()()(()))(()((()()))()(((()))())(()()()))))(())()(()))(((()((((())())()(((())(((())(((((()))((()()((()()())()))(()))()))(())())))())((()))(())))()((()()())))))))((()((())())(((())((()((())((()()()((())()))))()((((()()))(())((()(((())(()(()(()()))(((()()()((())()(())(()()())))(()))())(()))(((())))())))))(((())()()())))(()((()()()((())((()()((()((()())()))()))()())))()))((()(()())))))(())))()()()()))((())(())))(()())()))())()(())())()))))(()()((()()()())))))))()(()((((())((((()()((()())((((()))()())()(((((()(())))(((())))()(((()))())))((()))(((()))()(()))(()((()))((((()(()())))(((((()(())((()((()()(())))))))(())()(((()((((())())()(((()())))((()(()())((((())()()))()()((()())((()(())()()))())()()(()(())(()())())(()(()(())))))()()(((((((())((()((())())(()()))))(()()()((()()))())()()()(()(()()))()))()()()(()))(())())))())()()(()())())(((((((()))(())))))))((()((())())((()))(((())())())))))((())))))((())()))((()(())(()))))(((()(()))()())))(())()())(())())))(((()()))))(((()()((()(()(()())()(())()(((()))(())()()((())((()()(((()(()())(())))))(())((()()(((())))))(())())()((()()()(()()()))(()(((())()))()(((()))((()(((()(()()()(()))((())))))))))))()))(()))())))())(())()()(())()(()(()))))()()))())()((()(()((())(((()()()(()()(())))(()(()))(())((())))))))((((()()(())(((())))(())()(((((((()()(((()(()))(((()))))(((()())))((((()((()())))()((((((((()))(((()(()((())(()(()(())(())))()(((()))))())(()()))(()())(())())())()()()(())(())(()()(()(((())))(())(())))))()))())(()))())()(()())()(())())(()())(((((()()()(((((())(((())))))(()))()((()()()))))()()((())(())))(((()(((())()()())())()()()()()()()())))()(()()))))))))())()(())))())((())(()((())(()(())()())(())(((()(()(()())()()((())()()))))))))((((()()()))(()(((()(()()))(((()()(()()((())((())()(()(()))())()(())()))(()()()((()()()()(()()()))((()((()()(())((()(()(())()(())())()((()(())((()()()()()()(())()))())(()(()())(())(()(()))()(()()(())(((()())))()((((()()())(((()))(()(()()((((())(()((())()(())()()()))(()()()(()(((((()()(()))(()()))((()())(())((((()((()(()()()))(()(()(())(()()(()()))))()())())())()((((()(())))())(((()))()())((()))())()(()(((((())))))()()((((())((()))((()((())))))()(()()()(((()()(()()))(((()))())))()))))()))()))((((()())()))())()()))))())))()(()))))())()()((())((())))((()(()))))(())))()((()))()))((()))))(((()))))))((((())())((())()(()())((()))))((()())()((())((())((())(())))(()()()))(()(()()()((((())()))()(())(())()))((((())))))()()))(()((()(()(()(()((()())))()))(()())(((()((()())(())()((()))))())((()))()()))(()(()((())))(()()((()((((())(()(()()(()()((())(()))()()()))((())()))())()()((((())(()))))(()))())(())()())(((()(()((((()))(()()))())(((()(()))())(()))()())())()))((((()))()))((()()))))))((((()))(()))(())))))))(()))((((()))(()()())(()(())()()(()((()()))))(()(()(((()()))(((((()(())))(((()))()()()((((()((())()))))()))(()())(())((()))))())()())(()((((())()))()()))()((())()((((()))()()())()(()((()()()))())()()()()))())()))(())))()())()()()(())())())())(()())(((()))))))(()()))()()(()(((())(()()(()()()))(()((()(()(()())(()))())))(()(()(()(())())))((()())()((())))()()(())))(()()))(()))))))))(())(())(())))))()()()())(()())())(((()(()()((())))())(()((())))())))(()((((((((()()((())())))()((()))))((())()(()()())(())())()(())(())(()()(()(((((()((())()))))()))())))()())((((((()(())())))))))))((()())()((((((((()())())())()))((()()(()((((()()()(()()()))())))((((())))(()))())())((())())))(()()(()()(((()(((((()(()(()(()()(()))(()())()()))())(())((((()())))))())(()())()(()(()(()()))))(()))()()))((((()(())()())))()))((()((()((()(((()()((()))()()((()))))))(()()(())(((())()(()(()()))))()))))())())(())()))())))()()(((()()))(())(()))))(())())()(()(())())))(()))()())())))))))))))(((((())())))))(()((())(()))())))())()()(()(())()()))))((()))()))())))((()))))(())((())()(()))()())(()))())))(()(()())()))()()))(((()((((())(()(()((())((((()((())(())))))(()(())(()()(((((()((((()()()((()()()()(())()()))(())((())))(((()(()()(()(())))()))))))())()()))()(())())))())()((())))))()())))()((((()(((()))())()(()()()))))((((()))))()()(()()))((())((()(()))()())(()()))((()((()))))()(((())()))(((((((())()))((((()()()()))))())))))))(()(((()()())(()(()))(()()()()()(()()))))))))()(()(((((()))))(())(()())((()()))))))(((()))))())()))((((())(()()(((())(()(((())()((()())()))(())((()))())(())((((())())()()())(((())))()()((()())))()(())((())))((((()()(((())())()())()))((())((())((((())))))))())((()))((((((((((())))()()((((()((()))()()((())))()))))(()(()((())()))()())()((()()))())(()())())))()((()()())())()()(())()()(((())((())))())()))())))(()())()((())((())(((()())()(()(()())((())(()))()()))))()(()()()((()(()))()())())()())(()()))()()())))())()((()((()(())()())()()()((()))())()((()()()))())(((((())()))))))())(()(()((((()(())()())))()))))())))()())())())())((((()())()()(((()))((()(((((()())(((())(()()((()()((())))((()(((()((()(()))()())))())))((()())()())()())((()()((()((()))())()))(()((()((((())()()())()(()()))()((())((()()))((())))))))))())((()((()(()))()(((()(()())))))))())((()()(((()))()(()))()))((())((()))())()()()()(()()()(()(()())))((())))((())(((())))()()()((()((()))()())))))(((())(()(())(()()))()())()(((()()()()()))((()((())))())()()((()()))()))()((((()(()))((()((()()((()((()(()))(()()))()())))())()(()()(()((()()))))))())())((()())()())))())))()(()((()(((()()))())(())())()()))))((()(((())))(()))))()(((()))(()()()())()()))(())())(())()()()()()))((((((()(())(()))((())(())))(()(())(()()))))(((()(()(()(())())((()))()(())((((((()(()((()((((((())((()()())(())))()))())))))))()())()((((()(()()))((())))(()()()((())(()())))(())))(())()((((()())())()()()())()((()(()((((()()(())(((((((((())()())(())(()((((((()()())())())())())))()(((()()((()(()()(())))()()(()))))))(())()()))(((())))()()())()((())))(((())))()())))))()(()((((()))()(()()()))(((()((())()((()))()())(()()())((((()((((()))()))(())))(((((()())())))((((()()()()()())()))))((()()()((()(()(())((())()()())(()()())()(((())))((())()(())()())(()(()())))(()())())(())(((())(()))(()(())))))((()((((())(((()()))((())))))()((()())(())(()(())()(()))(())()()()())(()()()))))()))()))()()(((()(()())())()))(())(())(()))))()))())))))()())))()())))))()))))(((((())((()()))()()()(((())())(())))))(()(()())))())(()(()(()()))()()(()((()(())())())())(())())))())))))))((()))))((())())((((()))(()()))))))))((())()))()((((((())))(()()())))(())((()(())((()))(()()))(((()))))((((()()))((()()(())())()))())((()))())))())(()))((()()(()())))())))(((())(())(((()(()(()))((()()))()))))())(()((()((((()))((()()((()(((()())(()(())((()))())(((()))())())()()()(()((()(((((())))((((()()))())()))()(()()())(()((()(()))())))(())))())())))())((((()))))(()))))((()(()())))(())))())(()))))))((())(())())()(()))()(())()(())(())(()())))()(()()(((()()))())))()())))(()(()()))()((())))(()()))()(()()()())))())(((((((((()((()()())()(()(()())()((())))()())()))())()((()))()()(())(())(()(())))((()))(((()((()(((()(())))((())(()()))())((((((((()()(())()(((((()()(((((())()(()(()())))(()))))()((()))(()()((((()))()((()()())(()())()(()())(((((()()))()()())))((((((())()()())()(()()()(((()))()(())())))())(())))()(()(()(((()((()))))(()(()())()))()))()()()()))))((((()()()()()(()(()()((((()))()))))())((((((()(()((()(()()())((()()((())()()(((((()())((())))())()())(()()((())(())(()(()))()())(()(((((()()(((()()()(()(()()(())(())(()))))))((()()(((((()(((()((())))))())()()((()(()()))())((())((()()(()((()()())))))(()()(()()))())(()())()(()(()()))())(()(()))((()((()(((()))()()(()))())(())()((())(())))))())(()()(((((()(((()(()()()))()(()())))()))()(()))()(())()))((()))())))(()()))()()))()))((())((((((()(()()(()(((()())()())())())())))))))))())()))(()(()(()((((()()(())())))))))()(()()())((()(()((())))()())))())((((((())())()((())())))))))(())((())((((((())())()())(()()()))()())))()(()((((()))))(()(()()())))))))()))))((()()))()))(((()(()))(())(()))())))))((()))(((((()(())))))())())()(()()))())((()())(()((()()((()(()))()()())())())((()))((())()))))(())((()(()((()()())(()())((((()))()(()())(((()(()()()(()())))))(()()())()((())())()()()(()()())))()()()))))))()()(((()((())(()())))(((()))()()()((()())(()((((())())(((()(())))()))(((()(()(()))()())(()))))()))()(()()((()))))((()(()()()(()((()()()()))((()(())))(()((((((()()((()))()))(((())(()))))(())()())))(())())))))(()()((()(())))())(()))))()())())()))())((((())()))()((((()((((()(())()()(())(())()()))())(()()(())(()))(()))(()())))((()())())))))())()())(((()(((()(()()())))))(())()(())(()()()(()(()((()(((()()()())((())())()())()()()(()(()))(())))((((())()())()((()()(()()((()((()(()()())(((()))))()))())()())))()())()))))()()((())((())(()))(()()((()()))())()((())()(((((((()))())((())(((((())())((())(((()(())()())()(())))()())(()(()((()))(()))(()((()(()()())))(()))())(())(())))()()(()()()((()))(()))()((((()(((()(()()((()((((())((()(((())()())((())())(()())(())))((((((((()()))())(()())())())()())))))(()())(()())(()((()((()))(((())()))()()()(())))()()))))((())()()))()))))())))(()())())))()(()(()))())))()))()()(()))))(())()())()(()))()(())(())))()())()(()))))()()))()))))()))))())(((((()((((()()(())))())))()())(((()))()()((())()()()(((())()(()))((((())((((()()((((()(((()())))((())()(())(((())(((((((((()))()()))()(()()((()))(()))()))))((()))(()((((()(())((((()()()(()(())()))()(((())))())(()()(()(()((())(())()()())))))(((((()(()))))())((()((((((())()())((((((((()(()(((((()))((()()))))(()(()))()(((()(())()))))))((()())(())))))((())()))(())()))(()))))()))()))()()))()()((()(()))())((()(()((()()((()))(()((()(())(()()()(()()()()))()())())(()())))))()())(()(()())())(()())))())())))))()(((((()(()(()(((()(()())(()(()()))(((()(()(())()()(((())))))((((()(()(()))(())))))(()(((()())()))()(())))()(())))(((((((((()))((()))))()))())((())()(((((())()()(())()((((((()))))(((())()(((()((()())(())((((()))))))()()(())()()(()))))()))))()))))((())())))())))))()))))())())((())()())())())(()(())(((()()((()))()))(()(()()()))))(()))())(()))))((((()()())()((()()))(()))((()((((((((()((()))(())((())(()()((()(()()())()((())((((()()()(()(()))(()(())())))()(()))()))))()))()()(()())))(())())()))(())(()()())())())((((()())(()((()))(()(((())(()(((())())((((((()((()()(())((((()((((())))((()))()((()((())(()(()((()()(((()())()))))))())())()(()))((((((()))())((()()))))()()()))())))()()()())))))((((()(((()(()((()(()()()()())()))())(((()()))()(()()())(((((()())()())(()))(()))()())())(()((()(()(()((()((()(((())()))))))())(()((()(((()()))))((())()))()))((()))(()()(()((()())))()(()(()()))(()(()()()()(()))())()))(((()((((())())()(()))())(((()(()((()))(()()(()((())()))((())()())))()((())((()))())(()()((())((())))(((()()()())()()(()()()))((()(((())()()))((()(())))()))((())()())()())()((((()))()((()(()())())(()))(()(()))()())(())(()))()(()()((())()((((()((()()))())())(()))((()))()())((()(()(()))()()()))()()(()()())((((()))(()((())()(()))()()((())()()())))((())()(())()))(()))(((()())))))()((())()(())(((()())(((()((())()))()()))))()())())))(())((()))()))))())()))()(())))))))()())(())())))))()(((()())())(()()()))(()))())()(()(()(())()()((())))))((((()()(())(((((((()))()()(()()()(()()()())()(())(())()(()()))))()()((())()))))()))((((()()()()()))()))()()))()))(())()(())))(())()()()()()())(()(((()))()))))))))(((()((())((()((()()())(())())())((()())))(((()(()))))(((((()))))()))))()))())()((((()))((()))((((()())()())((((((()()()))()))(()((()(()())(())(()())())())()((((()((()((())((())(()))((()())(((()()())(((()))())()(())(())))())())((())((((())))())((((())((())))())()))((()()()(((()(())()(()))(()))(((((())(())()))()())())((()(()(()())())(((())()()))()(((((()(())())(((()()(()))))(())()((())))()))(()((())()()(())()())()()())))(()())))))))((())(()))))))(((()()))(())(()()()(()()()())())))(())()((()((()(((())(((())()(()()((((())))))(())(())(())((())())((())(()()((((())(())())())()(((())))))))))(()((())()))))())))(())()))()((()()(((((((()())))((())())((()()))))))())()((()))(()))()(()()))(()())((((()))(())()(()(()))))((()))((()()))))())()(())((()()()())(())))(())(())((())))))()(()(()()((())(()((()((()()))()())()(((())))(((())()()()((()))(()(())((()()())())(()((()()()((()((((()(()(()())(()(())()())()()()()()(())))()))((()))()()))(()())(())()()()(((())((()))())))))()()()(((()())(()()))(((()()))())))))((())))))()))()()(((((())()(()())))((()())(()()(())))(()(((()()())(((()))())()((())((())))))())())()())))))(()()(((()))(((()())()()((()))))()(())()))()))())))((())()()((()))(()()))()(()(()()()((((((((((()())()(()())((((()(()()))))((()((()()()))())))))(())()(())(()(()()(()))(())))())))(())(((())((()))(()(())())(()()((())((()))((())(()()()))())()()()((()))(()()))(())(())(())))()(()(((()((())()(((((()())()()(())(()())()(()))(((((((((())(()())()))(()(()(()()()()(((((()))()()))))((()))()))())(((()()()))(()(((()())()((((()())))))))()((()()()))(())(()()((())()((()))))(())()(()(((((((()))))(()(())(())((((()(()((())(())(((())()))(()()(())))())())(()())(())(((())))(()((()()())())))()))))(()))())(()()(((()))))))))()())())())))()(((())))(())(((()())))()())))(()()()(()(())))(())())((()())))((((()))())))(())))((()())(()))())))((()(())(((((()((())))((()()(()())(())((()()((()))())())))))))()))(())(()()())()))))))((())(((()()())()(((((()))()))()())(()(())))()(()())))))())(((((((()()))()())()))()(()()))((()((())(((()((())()(((()))((())()))()(()(()()()(((()())())()())))((()))))()))()()))())))()))))(()(()())(((()))((((()()()(((()()))))))(())))((((()((()(()))())())))(()(((())))))()(())))(()((((()))()()(()))(((())()(()()()((((()(((()()(()()()((((()((((()()))))()()(((())((((())()()()))))))())))(((()))()(((((()()((((()))))((()())(()()()())()))())()(())()))))(((()(()(()))(()())())))))))((((())())())()())(()()()()())))))(()()()(()(()(()((()))))((()(())))))))((((((()(((()))((()()())())))))())())((()))()(()))())((())))()))()(()(()))()(((())))()()))())((())(((()((())(((()(()()())()))))))(()(())()()(()())())()())))()(()())))))))())))))))))()()(((((()()()))(())())()()(()(())()()()()()(((()(((())((()(())(((((()(()(())(((()))))(())()))(()(()))))())()()())()(()))))())))(()()())()()((()()()(()()))(((()))))(()())((()((())(()((()((((()()((()())()))())(()(((())(()(((()))(())))(())()()((()((()((())))))(()()(())()()((()())((()()()()))()((())))()()())))())(()())((()(((()())))()))))(((((()(()))(()()()())))()()()((((()))()()(())()(())()()))(()()(()()))(((((((((((()))()()(()))(((()()))())()()(()())))))(()(()(()))((())(()(()(())))(()()())(((())())()))()))())(((()()((())))()()))))()((((((()())()))))()()(()(())((((())))))()((()))()(()())((()))())())()))((()))()())))((())()(())(()()((()((((((()())(((())()((()()))(())))()((()()(()))(()()(()()())())(()())(()((((()())((())())))(()()())()(()))(()())()((()())))))()))()(((((()())(()(()))(()))())))((()))()())())((((((()())())()()((()()()())()((()()))())((()(()(((()(()()((()()(((((()()()()(())(((())()))))())((())())))())((())))))))((()))()((()()())()))))((((()((((((()(()(())))((()))((())(((((((()()))(((((()(())()(()()()()(()()()))))))(()))()(((()()))(()((((())))()(((()))(()((()()(()(())())()(()((()(())())()()(()))())()(()))()))))))))(((()))()()())(((()))((()()(())()))()()())(()())((((()((())(())))))(()(()())())))())())())()()()()())())())))())))()))))(())()(((((())((((()(())(())))()(((()()(()(()))()()()((((((()(())())()(()(()))()()(((())(()(()(())(()((()())((())()(())()())))))))))))()(())())))))())())())()())))())()))))()())(()))(()))))(()(())))((((()))))))))())())))())(())))))()()(((((()((()))))(())())))))))()(((())))()))(()))((()))))((((((()))()(())(((()))()()()()()((()()))(((()))((((()))((()))))))()(((())((())(())))())()((((((()()()))(((((()(()()(((()(()))()()(((()))(()())(()()))()()())()()()))(()))(()((((((()()((()()(((((()())(()))()()()(((())()(()((()(()))()((()()((()))()()((((()((())))()())(())))(()()()(()(((())())()()))))(()()())())()(((((()))()()())))()))((())())()()(()(())()(((((())))()))))))((())())))()(()))(())))(()(())(()))((((((()())((()((()((()))))(((()((((()()))())))()))()(()))((()((()(((((())())((()()()()(((()(()(()())))))))())))(())))))((((())))(()(())))))))))()(()()(())()))(()())()()()((()((()))))(((()(())))()))))((()())()((()(()))()(()()))(()()()((()()()()))())((()()))(())((()()))(()())(((()))())())()()()()))()()()(()()()()))))))()(((((((())((())((()()(((((()(()())()()()())())()(()((())((((((()))))((())))()()))))(())())))))()())))))())())(((()()()((()))(())())((())()(()))(())((())()))))()))((()()))(()(())(((()()))())))(())()))(())()()())(()(((()))))))))(((()()(()()()()()()())(())))(())))()())))))())()()())()()(()()((()((())((()())))))())()(())()(()()(()))((()())))())()))))())))(((((()()()())())(()()))(((()((()))))(((((()(((()((()())()(((((())())(((()())((((()))(()())(()(()(()()(((())(((()(())))()()))()())()))()(()()()(((()(())((()(()((()(())())))(((()(())(())()()())((()())(()(()()())))))()))))))())(())()())()))())((()(()(()))(((())))()())))))))()()(()()())((((()(()(()()))))()())))(()(()(()())))))(()))()(()))))((()))((()(())()(()))()))(((()())(((())))))())))()(((())(()()()((()()()(())(())(()()((())())(())))())(()((()(((()((()()((((()())()())()((()(()(()))(()(())()(()(()))())((((())))())())((()(()()(()(()(((((())()(())()())(((()))()))(()(((())))()((()(()(()()(()(((()(()))()(((())((()))()(())())())(()())())))))())()(()(()())(()(()((((()))()()()()(()))(()(((((()())(())())))((()(()))()))))))(()(()())()(()(())()()(()(((())())())())(())))()(((((()()))))()(()()())()()(((((()(()(()()())()))(()()))())(()))))()))())())(())()())(((())((()()(()())((()(((())())))))()()())()))))))())(((()))((((((((()))(()())()()()(()()))())(((())()()())))()(())()((((((())()))))())())()()()()(((()((())())))))))())(())))((()()()(()((()((()))))())()()))(((((())())((()(((()())))((()(()()((()()()()((()))((()(())))(()()()(()())((()())(())()))())((())((())(((()((((()))))(()))((())()())((())()))(()()()))())))))(())(())))((())(((()))()()))()())()(())()())()()(()))(()))(()))((())(()(()((()(())(())()())())))(((())(())()()(()(()))()(())))()(()()(()))(())())())(())())(((()()(((())()()())()()()))))()(())())))())))(()()())(()))()()))))))(()(()))(()))())(()()(()((((((())()())))(((((()((()()())(())(()))((())(()())()()))))(())(((()(((())(((()((()))))))))())())(())))))())))))(((()))))()())()((((()((((())(()())((())())(()(()))()()(()(((())(()(()))(((())((())))))(())())()()))))(()))())((())()(((()(()()))()((((())((((()))(((()()))((()(()))(())((()))()(()((())()()((()))(())())()))())(((())(()(((()()((()()((()(()(())))))(((())()((((())((())(()()((())(())((()()((()(()((()()))())()(())()))(())(()(())((())()(()())())())())(()(()()(()(((()))))()())((()()((((()(()(((()(()(((()((())(()()()(((()(())(((()()((((((()(((()()((()(())(()))()))(((()())()()(())(())()(()()()(()(())(()()))((((())()(())()(()())()()(()(()())))))())()))()(()()))()(()((())))((())(()(())())()())())()()()))())))())()())((())(()()))(()))(()))(()()())(()())))((()()((()))))()((())((((())(()))()(()))))(()((((()()()))()(((())())()))(()())))))(((())))()))(()()()())()(()(()))()()())()()((()())())))(()))())((())))))(())(()()())()(()))))()())()((())))(())()()()(())(())(()())(())(((())(()(()((((((()(()(())())((()((()())((()()()))(()(()))(())(()))))((())(()(())(())))(()()((()((()()(()))(()(((((())(())(()())))((()((((((((())))))(()())())((((((((()()))(((((((())()())()(()))(()())(((()))()(((((()(()())(()()())))))(()()())((()))((((())))(()))())(()))(())()()((())(((((((()((((()(()(((((()()(())))()())))()(()))))((()))))()())))))((((())((()))))()(())()())()((())(((()(())()))())))()()(()))(()())((()()))))()))()((())())())))(())()(()))()(())()()))()))((()))))((((((())((((())))))))()(()(((((()()))))((((())))())(()(()())()()))))(((()()(((()))((()(())))))())(()())())()(((()(()(())(()()))()())()())(()((((()(()()))))))())()((()(()()()())))))()))))()()(()))())))()()(()()((())))()(()(()))()()(())))()(()((()((()()()()())()())(()))))(((()))))))()((())(()((()))())((()(()))))))())()(()(())()))()))())(((()))()))(()(()(()))(()()((()(())(()))))()))(()()((((()(((()))(()))))(())()()((((()((((())((())(()((()(()(()()()()()(())((()))))))()))))(()()(())()(((())()))(((((()()((()((((())(((())()))((()())(()()()))()()(()(((()(())()))())((()()()()((()(()((((((()))()()((()((()()))(()((()()))()(())(())())(())((((()())))())(())(())(()(())))))()))()()(((()()((((((()(()))((()()(())()((((()(((())))()())(()))(()()(()))))))(((())))())())))()()())(()())))((((((()(()())())())))()))((((((()()()(()()())())((())((())))())())()))))))))(((())))(())())()))((((()))(())(()())(()))()(((()))()))())()))))())()(())()()((()))()())((())((()(((((()((()))(()))((()(())()()((())((()(())(()(()((((())()(((((())))())))(()()((()(()()()(()(((()(())(()((())(())()(()(()()(((((()))))(()))(((())(()())))()))()())((())))()((((()(())())()))))())())))())()()(()()(()())(()()))())()))())(())))())))()(((()()(())((()()((()()()()())(())((())(()))((())))(()())))))))(())()))))(())()(())(()))))()))(((()())))((())))((((())))()))())((()())((()())((())((()()))()((((()))()))(()(()(()((()(()))(()())))))(()))((((((()))(()))))(())((((()()))())()(())()((()())((()(()(((((())())()()()()()()(()))))))))(()()()((()()(()())(()))))(()()((((()(())(()()((()())))))((())(()(()(())()((()(((())))(())))()((()()(()(())(()(()()))()((()()()))((((()))))())))(()(()))((()()))))((()()()))((())()))())()))(()((()(((((()())((((()(()()(()())())()))(()()()())((()(()))())()())))((()))))))(((()()))()())())())(((()())(())(()(()))(()())))((()()()())()))))()))))))(()()))((()((())))(((',
         ]:
    print(f's = {s}')
    sol = Solution()
    r = sol.longestValidParentheses(s)
    print(f'r = {r}')
    print('===================')

