#
# Incredible solution that uses O(1) extra space!! The other DP or stack based solutions
# use O(N) extra space.
#
class Solution:
    def longestValidParentheses(self, s: str) -> int:
        N = len(s)
        left_brackets, right_brackets = 0, 0
        res = 0
        for ch in s:
            if ch == '(':
                left_brackets += 1
            elif ch == ')':
                right_brackets += 1
            if left_brackets == right_brackets:
                res = max(res, left_brackets*2)
            elif right_brackets > left_brackets:
                left_brackets = right_brackets = 0
        left_brackets, right_brackets = 0, 0
        for ch in reversed(s):
            if ch == '(':
                left_brackets += 1
            elif ch == ')':
                right_brackets += 1
            if left_brackets == right_brackets:
                res = max(res, right_brackets*2)
            elif left_brackets > right_brackets:
                left_brackets = right_brackets = 0
        return res

# Main section
for s in [
            '(()',
            ')()())',
            '',
            '()()()()()',
            '())((())',
            '()(())(',
            '(((())()()())((',
            '(((())()()()(((',
            '(()))())(',
            '(()((())))()()))((())(())))())())))(((((((()()(()())())))))())()(())())(((((((((())()((()(((())(())(',
            '()())()(()()))((()())()))))))()((()(()())()))()))))()(()())))))(((()()()())((())))(())(()()())))))(((())())))(((())()))(()))(((())()((())(()(()))((()())((())(())))()(((((())(()))())())()()(((()()(()(((()))()))(()(()))))()))()()((()()(((()(((((()(())(((()()((((()))))()(((())(()))(((()))()(()()()()()((())))))()(())((())(())((((()()))))(()))())(())))()()(()))())()()))()((((())))()))(((()())()()))))()()(())(())(((())()((()))(()((()()())()()(())((()))))))(())()()))(())()()))))()(()((())()()((()()()((()()((()((())))(((()(()())(((()((()))()((()))()((())())))())(()((())(()()())((()()))()())()()(()()()))(()))())((()(())()((())(((())(()))((()())((()()()))))()))())()))()()))))((())((((()))))((())(((((((()()(())())(()(()(()((()())(())(())))()((()((()))))(()(()(())(((()((())))((()())(((((()((()())))()()(()))(()(()()(())))()())))()))((()())()))()()))()(()((((()()))((()))(()))(()((()))))))(((()((((()())))))()(()()()(()()((())((()))()(())))()(())(()(()()(()()(((((()((()))(((()(()()())(())))))))()))))(',
            #')())(())))(())))))()(())(()((()(((((((()())))))(((())())()((())((()))))((()())))()))((((()((()()(())(()()(()((((()((()()))))))())()((()))()())))(())))())))((()))()())())()(()))((()))))))())))))(((())()())())())()))()(((()()))()())()()))((()))))())((()())(()()))))))())((((()))((())(()()())((((()((())))))))()((()(()())))(()())))))))))((((())((((()()))))(()()(())(()())(())()(((()))(())(()))()((())())(((()))(())())((())(())))()())(()))()((()()))))((())()()))((()()(())(()(()()))(())((()))()))))())()())())()(())()))())))((()(())((()))()()())))))))()()()(())))())()))))))()()())))))(()(())())(())()))())))(()())(()())()()))()(())(()))(()()()(()()()(((()(())((()(())()(())(((()(()))))(()()()())(((()))()))()(()()(())))((()())())))((()()))())))())(()(((()((()(()))))())(())((()))))))()()()(()(((())))((())())))(()((()(()))))()))((()()())()))))(()(()(())((()()()()(())))()())(()())()()((((()))(()()())))))()(()()())((())(())))()(())()(()))))((()(())(((())(((()(()((((((((()())))))()(())(()())((((()()(()(()))))(()(()))()))))((())())((())(()())())()))()()(((((()(((())())((())((())()()(()()))))(((((())()(((((())(((()(()()()))))))(()())()()(()(())))())(()((()(((())(((((())()))()(()))(()(()((())())((())()()()()))()(())((()((()((((((())))))(()()((((((())()(((())(()()()))))((()())(()()(((()))()()()()))(())((()))(()((((())))())(())())))(()))(((()(()))))(()(())())())))()))(()((((()(()((())))))(((()(()))((())))(()(()))))((((()))(()(()(())()((()))(())(((())(()()))())(()(()(()()))()()())((())((())(())()((()((()()))))()))(((((())()())()(((()()())()(()()(())()(((()(((()((((()(()())(())())(()))()(((()))()(()())()(())())()(()(()())))))))()(())(()()(())))()(()())(())())((())))()(((((())((()((())(()()()))())()(()(()(())(()(()()()((())()((()(((()())(())))))()(()()))))(((((())))(()(((())())())(()))()()))(((((()()())))))()()()()()(((((()()())(()(()(()(()))()((())((()(((()(()((())((()(()())))))()()(()()(())())))))))()(()(((())())))(()())())((()))))))(())((())()()()()(()(((()(()())()((())))((()())()))))(()()((()()(()()())(()))(())()((()()((()()))()()())()((())(()))))(())()())()(())(((()(()))())()))(()((()))))()((()(()((())()))(()))(()))())(())()())((()((()(()()))(()))()))((((())()(())))(()(())((((((())()))(()))))(())())((())((()))(())())()))))()()(((()((()()((()))(((((()())())((())())(()((())()(((()))()))))(((((()(())()())())))())((())(()())()(()))(())())((((()))))))))())(())()(()(()(()(((()())()())(()()())()()))(()))))(((((()))((()))((()))(())))))((((()))()(()(())))(()((())(()(())()()()((((()))())()))(()))))())((((())(()(())(())(((())()((()()))((()()))()()(())())(())))))(()(())))))))()()))()()))(()(()(()()(()()))()(((()(()()(((()()((()(())(((())()()()())(())(((())))(((()))(((()))(())(((((((())(()))()))()())((()())()()(()(()(()()()()))())((()()))(()(((((())))())())))()(())))()))(((((()(((())(())()())(((()(()(())()(()(()((((((()())((())()()()(()()()(()(()))(((((((())))((((()(()))))))())()()())))(())((()()()))()))((()())(())()))))()(()()))(())))())((()))())())))(()(())(()(())((((((()(((((((((()((()())())())(())())(()((()(()(()(()()(((((())(())((())((())())()))))()()())(())))()((()(()())((())((())((((())))))()))()()(()(()()()))(()()(()())))(()))))))(((((())))())))(())(((()((())))))()()))()(())))()))()))()()))((())())))(())((()))())))(()()()((())((((()(())())()))()))((())()()))()())()())(()))((((()))()(()()(((()))))()((())(((((()(((((()()))()()(()))())(()((()((()(()()((((()))(())))(((((())((()())()()(()))()((())())))()()(()()))))())(()((())(()))(()()))()(((()((()(()(()))))))(()(()(((()(((((()(()())(()))()())(()((())()(()(((((())((()))))(())((((((((((()(()(()))(()((()()((())())))())(()))))(()(()))())()))(((()(()(()((((()(()))()()))))))))()())(()()))))))(()(()((((()(()))()()))(()(((())))))(((())))((()()(())(())))())(())))()))((((())(((()(())((())(((())()()()()(((((()()())(()))()()())()))((())))()((()(())((((())(()))())(()()())(()))((()()((((()))()()()))((((((((()(((((())(((()))()))))(()))())))))()((()((((())))(((())))))))(()))())(())((((((()((((())()(())(()())(()((()())(())((((()(())))())()())()(((()(())))()))(()(()((()(()((()(((()(()((()))())(((())())((()()()())((())))((((()))))()()()((((())()))(((((()))(()())))(((((())()()()()(()(((()))(())(())(((())()())(())(()(()()(()))()(()((()()((((((())((((()))))()))()(()))()((()())((()())()(((()())))(()())())))))))))((((()(()((((())(()())()))))())(()))()))))())))))()((()())))()))()(()(()((())(()))((())(()((((())()()()()(()))))()()()()(()())))())))((()))()()()())(()()))(())()()()(()))()((()()(()(((((((()(()(()())((()((()(()()))))))))()))())(())(()(()((())))))()()())))((()())())()))(()()))()(())((()())())()((())))))))))(((()())()))()())))()))((()()(((())())())))()()((())()(())))))(())(((()(()()()()()))((())()(((()(((((((()))()))()((())((())(()(())(((()((()(()(()()(((()()()(((())((((()))))())))()((((()((()))((((())())()()))())))(()()()()()(()())(()()((())))((((((())()())))()((()))()()(())()))(((((()))))(()))())(())(((()())(())((()()(((()()((()(()(()()()((()()((())(())()((()))()()(((())()(()((((((()))(((())))((()())))(()))))(())))()))))()()(()))))))()))(()((()())(()())((((())()))))())())())))()()(()))()))(()(())))(((()(((()(()))((())(((((((()(()((()((((()(()())())))(((((()()()()()(())))((())())(())(()))))))))((((()((())()())((((()()))())(())))))((()()())))()))))(()))(()())((((()(((()))(((((()())(((((())(((()((()()()(()(((((())((())))(()))((())(()))()))(((()((()(()())())())())))))))))())))))())()())))()())())((())((((((((())((())(()())((())()((())))))))())()((()))()(()(())))()()(((())()()(()))))))))))()((())()(()(((((())))((()((())()))((()((((()(()()(()()))))((((()()())))()())(()()(((((()()()))))()()())))()()(()(()()(((((()(()(()()()())((((())((())(()((((())((())((()()((((())()())))())()()(()(())())()((()())())()((()(())(()(()())()()((()((()((((())())(()()))(()(())(()(())(())(()()(()(()((()(((())()(((()(()()()())(())())((())(())())(()((()))()((()))())())()()(((((()))())(()))()()()))()()()(())))()))(())()(())))))()(((()()(()()((()(((()(()((()()()()))()(()(((()((())(()()((((((()(()())))())()(())(()())((())))()(()()))))())(()()())()))())(()()))()()()()(()()))((()))()((()))())())))())))))())((()(()((()(())(()())()))()))()()(())(()())((()()(())((()((((()(()))()(((((())()()))(((((()(()())(()())((()()((()()((()))))))))(()()))(())()()())(((()((()(()())(()(())()(()((()))))(((()()()((()()))((()(())((()((((()(()(((()()(((()(())))()(()()(((()((()())()(()((()())((((()(()))())()())(()()((()(()))))))(()())()(())((())))))))((())))(())))))()()((())))()())((((())(((())()())(())))(())(((()(()((())))((((())))()(()(()))((()())((()())()))))((()(()()))))(())(())))())))()()((()))())()(()()(()))))((()(()())()(()()()))(((())())))))((((()(((((()())((()(((()())()))(())()())())))(())))))()()())))()())(((()((())()))()()(()))((((())(())()()()((())()))))(()((())))))()()(((()(((()()))))((((()(())())()((())))()))()())()(((()(()((())()(())))(())(())()()))())(((()())())(())))(()))(()(())))()())))(((())()(()()))()()()))((()()))))))))()(())(((((()()())))(())((()))))(((()(()()(((()()()(()(()))))))))()(())((()()((()(())((())))()(())((())(())))(())()(((())()))((((()()()((()()(())()()()())()))(((((()))))())))())(()())(()())()(((()())((())()()))((()(((()())(()((((()(()((()))()()))()))()(())((()()))()((())(())(()(()()))()))(()))())))()))))))(()()())())())(())((()))((()((()))((())(())((())()))())(()()))(((()(()())(((()((()()))())(()()))()))()))((()))))())))())()()(()((((()()((()()()()))()()))())))(((()(()))))(()()((()(()()((())))))())(())((())()(((((()()(())()))()((())())))(((((()()((()())))))())()()((()))))(())()(()(((()((()((((())))(())(())()(((())()()))()))((())())((()(()))(((())(((()))))))(((((()()(()(()((((()()()(()())())()())((()(((())(()((((()())()()((())()(((((()()()(((())((((()(()((()(((()))))()()()((((((((((((()))()()((((((((())()))((((())()()((()(()(((()))()()())(()(((()())))(()(())()()())()(()((()))()(()))(()(())(())((((())((()(()()))((())))((()))))((((()(()(()))()))())(())())(()))))))())))(())())()))((()()))(((((((()))))((()())(())))(((()()))(())()(((()((()))((())()(()((()(((())((()))))(())()))()))(()((()()))()))(()(()()(((((()))()))())))(((())()))()()((((()(()((()(((())(())()((((()(()())(()())()())))((()((()(()))()((((((()()((()()())(())(())))())(())())(()()))))((()()(()(()(())()))((())(())())(())(())))(())(()(())())(()())(()(()))))))))())))(())))(())))())()()()())()(())()()))(()())))())(()())((()))()((()()))(()()()())()(((()))()(()((())()()()((()(()(((()))(()))))))((((()()((((()))(()))(()())(()))))(()))((()(()(())())())((((()))())))()()(()(())()))()(()((()))(()(()()))())((()))())()()()((()))(())(()))))())(()())))(()((()()()(())())))(()()(((())())())())(()()())()((())(()))()(()))((((()())(()()(()(((()()())())()))))(())(()(())))(((()(((())()())()()(()))))(())())((()()((((()((()))()(()()()(())(()(()(()()((()(((())()))(()())(()))))((())()()())))(())()))(((()))(())(()((()((()))(()))()((())(((()()))()()(()((()))((()(())))()(()())))())())()((((((((())))()()))))(((())()(()()(()))(()((()()))()(((()))())(()()()))))(())()(()))(((()((((())())()(((())(((())(((((()))((()()((()()())()))(()))()))(())())))())((()))(())))()((()()())))))))((()((())())(((())((()((())((()()()((())()))))()((((()()))(())((()(((())(()(()(()()))(((()()()((())()(())(()()())))(()))())(()))(((())))())))))(((())()()())))(()((()()()((())((()()((()((()())()))()))()())))()))((()(()())))))(())))()()()()))((())(())))(()())()))())()(())())()))))(()()((()()()())))))))()(()((((())((((()()((()())((((()))()())()(((((()(())))(((())))()(((()))())))((()))(((()))()(()))(()((()))((((()(()())))(((((()(())((()((()()(())))))))(())()(((()((((())())()(((()())))((()(()())((((())()()))()()((()())((()(())()()))())()()(()(())(()())())(()(()(())))))()()(((((((())((()((())())(()()))))(()()()((()()))())()()()(()(()()))()))()()()(()))(())())))())()()(()())())(((((((()))(())))))))((()((())())((()))(((())())())))))((())))))((())()))((()(())(()))))(((()(()))()())))(())()())(())())))(((()()))))(((()()((()(()(()())()(())()(((()))(())()()((())((()()(((()(()())(())))))(())((()()(((())))))(())())()((()()()(()()()))(()(((())()))()(((()))((()(((()(()()()(()))((())))))))))))()))(()))())))())(())()()(())()(()(()))))()()))())()((()(()((())(((()()()(()()(())))(()(()))(())((())))))))((((()()(())(((())))(())()(((((((()()(((()(()))(((()))))(((()())))((((()((()())))()((((((((()))(((()(()((())(()(()(())(())))()(((()))))())(()()))(()())(())())())()()()(())(())(()()(()(((())))(())(())))))()))())(()))())()(()())()(())())(()())(((((()()()(((((())(((())))))(()))()((()()()))))()()((())(())))(((()(((())()()())())()()()()()()()())))()(()()))))))))())()(())))())((())(()((())(()(())()())(())(((()(()(()())()()((())()()))))))))((((()()()))(()(((()(()()))(((()()(()()((())((())()(()(()))())()(())()))(()()()((()()()()(()()()))((()((()()(())((()(()(())()(())())()((()(())((()()()()()()(())()))())(()(()())(())(()(()))()(()()(())(((()())))()((((()()())(((()))(()(()()((((())(()((())()(())()()()))(()()()(()(((((()()(()))(()()))((()())(())((((()((()(()()()))(()(()(())(()()(()()))))()())())())()((((()(())))())(((()))()())((()))())()(()(((((())))))()()((((())((()))((()((())))))()(()()()(((()()(()()))(((()))())))()))))()))()))((((()())()))())()()))))())))()(()))))())()()((())((())))((()(()))))(())))()((()))()))((()))))(((()))))))((((())())((())()(()())((()))))((()())()((())((())((())(())))(()()()))(()(()()()((((())()))()(())(())()))((((())))))()()))(()((()(()(()(()((()())))()))(()())(((()((()())(())()((()))))())((()))()()))(()(()((())))(()()((()((((())(()(()()(()()((())(()))()()()))((())()))())()()((((())(()))))(()))())(())()())(((()(()((((()))(()()))())(((()(()))())(()))()())())()))((((()))()))((()()))))))((((()))(()))(())))))))(()))((((()))(()()())(()(())()()(()((()()))))(()(()(((()()))(((((()(())))(((()))()()()((((()((())()))))()))(()())(())((()))))())()())(()((((())()))()()))()((())()((((()))()()())()(()((()()()))())()()()()))())()))(())))()())()()()(())())())())(()())(((()))))))(()()))()()(()(((())(()()(()()()))(()((()(()(()())(()))())))(()(()(()(())())))((()())()((())))()()(())))(()()))(()))))))))(())(())(())))))()()()())(()())())(((()(()()((())))())(()((())))())))(()((((((((()()((())())))()((()))))((())()(()()())(())())()(())(())(()()(()(((((()((())()))))()))())))()())((((((()(())())))))))))((()())()((((((((()())())())()))((()()(()((((()()()(()()()))())))((((())))(()))())())((())())))(()()(()()(((()(((((()(()(()(()()(()))(()())()()))())(())((((()())))))())(()())()(()(()(()()))))(()))()()))((((()(())()())))()))((()((()((()(((()()((()))()()((()))))))(()()(())(((())()(()(()()))))()))))())())(())()))())))()()(((()()))(())(()))))(())())()(()(())())))(()))()())())))))))))))(((((())())))))(()((())(()))())))())()()(()(())()()))))((()))()))())))((()))))(())((())()(()))()())(()))())))(()(()())()))()()))(((()((((())(()(()((())((((()((())(())))))(()(())(()()(((((()((((()()()((()()()()(())()()))(())((())))(((()(()()(()(())))()))))))())()()))()(())())))())()((())))))()())))()((((()(((()))())()(()()()))))((((()))))()()(()()))((())((()(()))()())(()()))((()((()))))()(((())()))(((((((())()))((((()()()()))))())))))))(()(((()()())(()(()))(()()()()()(()()))))))))()(()(((((()))))(())(()())((()()))))))(((()))))())()))((((())(()()(((())(()(((())()((()())()))(())((()))())(())((((())())()()())(((())))()()((()())))()(())((())))((((()()(((())())()())()))((())((())((((())))))))())((()))((((((((((())))()()((((()((()))()()((())))()))))(()(()((())()))()())()((()()))())(()())())))()((()()())())()()(())()()(((())((())))())()))())))(()())()((())((())(((()())()(()(()())((())(()))()()))))()(()()()((()(()))()())())()())(()()))()()())))())()((()((()(())()())()()()((()))())()((()()()))())(((((())()))))))())(()(()((((()(())()())))()))))())))()())())())())((((()())()()(((()))((()(((((()())(((())(()()((()()((())))((()(((()((()(()))()())))())))((()())()())()())((()()((()((()))())()))(()((()((((())()()())()(()()))()((())((()()))((())))))))))())((()((()(()))()(((()(()())))))))())((()()(((()))()(()))()))((())((()))())()()()()(()()()(()(()())))((())))((())(((())))()()()((()((()))()())))))(((())(()(())(()()))()())()(((()()()()()))((()((())))())()()((()()))()))()((((()(()))((()((()()((()((()(()))(()()))()())))())()(()()(()((()()))))))())())((()())()())))())))()(()((()(((()()))())(())())()()))))((()(((())))(()))))()(((()))(()()()())()()))(())())(())()()()()()))((((((()(())(()))((())(())))(()(())(()()))))(((()(()(()(())())((()))()(())((((((()(()((()((((((())((()()())(())))()))())))))))()())()((((()(()()))((())))(()()()((())(()())))(())))(())()((((()())())()()()())()((()(()((((()()(())(((((((((())()())(())(()((((((()()())())())())())))()(((()()((()(()()(())))()()(()))))))(())()()))(((())))()()())()((())))(((())))()())))))()(()((((()))()(()()()))(((()((())()((()))()())(()()())((((()((((()))()))(())))(((((()())())))((((()()()()()())()))))((()()()((()(()(())((())()()())(()()())()(((())))((())()(())()())(()(()())))(()())())(())(((())(()))(()(())))))((()((((())(((()()))((())))))()((()())(())(()(())()(()))(())()()()())(()()()))))()))()))()()(((()(()())())()))(())(())(()))))()))())))))()())))()())))))()))))(((((())((()()))()()()(((())())(())))))(()(()())))())(()(()(()()))()()(()((()(())())())())(())())))())))))))((()))))((())())((((()))(()()))))))))((())()))()((((((())))(()()())))(())((()(())((()))(()()))(((()))))((((()()))((()()(())())()))())((()))())))())(()))((()()(()())))())))(((())(())(((()(()(()))((()()))()))))())(()((()((((()))((()()((()(((()())(()(())((()))())(((()))())())()()()(()((()(((((())))((((()()))())()))()(()()())(()((()(()))())))(())))())())))())((((()))))(()))))((()(()())))(())))())(()))))))((())(())())()(()))()(())()(())(())(()())))()(()()(((()()))())))()())))(()(()()))()((())))(()()))()(()()()())))())(((((((((()((()()())()(()(()())()((())))()())()))())()((()))()()(())(())(()(())))((()))(((()((()(((()(())))((())(()()))())((((((((()()(())()(((((()()(((((())()(()(()())))(()))))()((()))(()()((((()))()((()()())(()())()(()())(((((()()))()()())))((((((())()()())()(()()()(((()))()(())())))())(())))()(()(()(((()((()))))(()(()())()))()))()()()()))))((((()()()()()(()(()()((((()))()))))())((((((()(()((()(()()())((()()((())()()(((((()())((())))())()())(()()((())(())(()(()))()())(()(((((()()(((()()()(()(()()(())(())(()))))))((()()(((((()(((()((())))))())()()((()(()()))())((())((()()(()((()()())))))(()()(()()))())(()())()(()(()()))())(()(()))((()((()(((()))()()(()))())(())()((())(())))))())(()()(((((()(((()(()()()))()(()())))()))()(()))()(())()))((()))())))(()()))()()))()))((())((((((()(()()(()(((()())()())())())())))))))))())()))(()(()(()((((()()(())())))))))()(()()())((()(()((())))()())))())((((((())())()((())())))))))(())((())((((((())())()())(()()()))()())))()(()((((()))))(()(()()())))))))()))))((()()))()))(((()(()))(())(()))())))))((()))(((((()(())))))())())()(()()))())((()())(()((()()((()(()))()()())())())((()))((())()))))(())((()(()((()()())(()())((((()))()(()())(((()(()()()(()())))))(()()())()((())())()()()(()()())))()()()))))))()()(((()((())(()())))(((()))()()()((()())(()((((())())(((()(())))()))(((()(()(()))()())(()))))()))()(()()((()))))((()(()()()(()((()()()()))((()(())))(()((((((()()((()))()))(((())(()))))(())()())))(())())))))(()()((()(())))())(()))))()())())()))())((((())()))()((((()((((()(())()()(())(())()()))())(()()(())(()))(()))(()())))((()())())))))())()())(((()(((()(()()())))))(())()(())(()()()(()(()((()(((()()()())((())())()())()()()(()(()))(())))((((())()())()((()()(()()((()((()(()()())(((()))))()))())()())))()())()))))()()((())((())(()))(()()((()()))())()((())()(((((((()))())((())(((((())())((())(((()(())()())()(())))()())(()(()((()))(()))(()((()(()()())))(()))())(())(())))()()(()()()((()))(()))()((((()(((()(()()((()((((())((()(((())()())((())())(()())(())))((((((((()()))())(()())())())()())))))(()())(()())(()((()((()))(((())()))()()()(())))()()))))((())()()))()))))())))(()())())))()(()(()))())))()))()()(()))))(())()())()(()))()(())(())))()())()(()))))()()))()))))()))))())(((((()((((()()(())))())))()())(((()))()()((())()()()(((())()(()))((((())((((()()((((()(((()())))((())()(())(((())(((((((((()))()()))()(()()((()))(()))()))))((()))(()((((()(())((((()()()(()(())()))()(((())))())(()()(()(()((())(())()()())))))(((((()(()))))())((()((((((())()())((((((((()(()(((((()))((()()))))(()(()))()(((()(())()))))))((()())(())))))((())()))(())()))(()))))()))()))()()))()()((()(()))())((()(()((()()((()))(()((()(())(()()()(()()()()))()())())(()())))))()())(()(()())())(()())))())())))))()(((((()(()(()(((()(()())(()(()()))(((()(()(())()()(((())))))((((()(()(()))(())))))(()(((()())()))()(())))()(())))(((((((((()))((()))))()))())((())()(((((())()()(())()((((((()))))(((())()(((()((()())(())((((()))))))()()(())()()(()))))()))))()))))((())())))())))))()))))())())((())()())())())(()(())(((()()((()))()))(()(()()()))))(()))())(()))))((((()()())()((()()))(()))((()((((((((()((()))(())((())(()()((()(()()())()((())((((()()()(()(()))(()(())())))()(()))()))))()))()()(()())))(())())()))(())(()()())())())((((()())(()((()))(()(((())(()(((())())((((((()((()()(())((((()((((())))((()))()((()((())(()(()((()()(((()())()))))))())())()(()))((((((()))())((()()))))()()()))())))()()()())))))((((()(((()(()((()(()()()()())()))())(((()()))()(()()())(((((()())()())(()))(()))()())())(()((()(()(()((()((()(((())()))))))())(()((()(((()()))))((())()))()))((()))(()()(()((()())))()(()(()()))(()(()()()()(()))())()))(((()((((())())()(()))())(((()(()((()))(()()(()((())()))((())()())))()((())((()))())(()()((())((())))(((()()()())()()(()()()))((()(((())()()))((()(())))()))((())()())()())()((((()))()((()(()())())(()))(()(()))()())(())(()))()(()()((())()((((()((()()))())())(()))((()))()())((()(()(()))()()()))()()(()()())((((()))(()((())()(()))()()((())()()())))((())()(())()))(()))(((()())))))()((())()(())(((()())(((()((())()))()()))))()())())))(())((()))()))))())()))()(())))))))()())(())())))))()(((()())())(()()()))(()))())()(()(()(())()()((())))))((((()()(())(((((((()))()()(()()()(()()()())()(())(())()(()()))))()()((())()))))()))((((()()()()()))()))()()))()))(())()(())))(())()()()()()())(()(((()))()))))))))(((()((())((()((()()())(())())())((()())))(((()(()))))(((((()))))()))))()))())()((((()))((()))((((()())()())((((((()()()))()))(()((()(()())(())(()())())())()((((()((()((())((())(()))((()())(((()()())(((()))())()(())(())))())())((())((((())))())((((())((())))())()))((()()()(((()(())()(()))(()))(((((())(())()))()())())((()(()(()())())(((())()()))()(((((()(())())(((()()(()))))(())()((())))()))(()((())()()(())()())()()())))(()())))))))((())(()))))))(((()()))(())(()()()(()()()())())))(())()((()((()(((())(((())()(()()((((())))))(())(())(())((())())((())(()()((((())(())())())()(((())))))))))(()((())()))))())))(())()))()((()()(((((((()())))((())())((()()))))))())()((()))(()))()(()()))(()())((((()))(())()(()(()))))((()))((()()))))())()(())((()()()())(())))(())(())((())))))()(()(()()((())(()((()((()()))()())()(((())))(((())()()()((()))(()(())((()()())())(()((()()()((()((((()(()(()())(()(())()())()()()()()(())))()))((()))()()))(()())(())()()()(((())((()))())))))()()()(((()())(()()))(((()()))())))))((())))))()))()()(((((())()(()())))((()())(()()(())))(()(((()()())(((()))())()((())((())))))())())()())))))(()()(((()))(((()())()()((()))))()(())()))()))())))((())()()((()))(()()))()(()(()()()((((((((((()())()(()())((((()(()()))))((()((()()()))())))))(())()(())(()(()()(()))(())))())))(())(((())((()))(()(())())(()()((())((()))((())(()()()))())()()()((()))(()()))(())(())(())))()(()(((()((())()(((((()())()()(())(()())()(()))(((((((((())(()())()))(()(()(()()()()(((((()))()()))))((()))()))())(((()()()))(()(((()())()((((()())))))))()((()()()))(())(()()((())()((()))))(())()(()(((((((()))))(()(())(())((((()(()((())(())(((())()))(()()(())))())())(()())(())(((())))(()((()()())())))()))))(()))())(()()(((()))))))))()())())())))()(((())))(())(((()())))()())))(()()()(()(())))(())())((()())))((((()))())))(())))((()())(()))())))((()(())(((((()((())))((()()(()())(())((()()((()))())())))))))()))(())(()()())()))))))((())(((()()())()(((((()))()))()())(()(())))()(()())))))())(((((((()()))()())()))()(()()))((()((())(((()((())()(((()))((())()))()(()(()()()(((()())())()())))((()))))()))()()))())))()))))(()(()())(((()))((((()()()(((()()))))))(())))((((()((()(()))())())))(()(((())))))()(())))(()((((()))()()(()))(((())()(()()()((((()(((()()(()()()((((()((((()()))))()()(((())((((())()()()))))))())))(((()))()(((((()()((((()))))((()())(()()()())()))())()(())()))))(((()(()(()))(()())())))))))((((())())())()())(()()()()())))))(()()()(()(()(()((()))))((()(())))))))((((((()(((()))((()()())())))))())())((()))()(()))())((())))()))()(()(()))()(((())))()()))())((())(((()((())(((()(()()())()))))))(()(())()()(()())())()())))()(()())))))))())))))))))()()(((((()()()))(())())()()(()(())()()()()()(((()(((())((()(())(((((()(()(())(((()))))(())()))(()(()))))())()()())()(()))))())))(()()())()()((()()()(()()))(((()))))(()())((()((())(()((()((((()()((()())()))())(()(((())(()(((()))(())))(())()()((()((()((())))))(()()(())()()((()())((()()()()))()((())))()()())))())(()())((()(((()())))()))))(((((()(()))(()()()())))()()()((((()))()()(())()(())()()))(()()(()()))(((((((((((()))()()(()))(((()()))())()()(()())))))(()(()(()))((())(()(()(())))(()()())(((())())()))()))())(((()()((())))()()))))()((((((()())()))))()()(()(())((((())))))()((()))()(()())((()))())())()))((()))()())))((())()(())(()()((()((((((()())(((())()((()()))(())))()((()()(()))(()()(()()())())(()())(()((((()())((())())))(()()())()(()))(()())()((()())))))()))()(((((()())(()(()))(()))())))((()))()())())((((((()())())()()((()()()())()((()()))())((()(()(((()(()()((()()(((((()()()()(())(((())()))))())((())())))())((())))))))((()))()((()()())()))))((((()((((((()(()(())))((()))((())(((((((()()))(((((()(())()(()()()()(()()()))))))(()))()(((()()))(()((((())))()(((()))(()((()()(()(())())()(()((()(())())()()(()))())()(()))()))))))))(((()))()()())(((()))((()()(())()))()()())(()())((((()((())(())))))(()(()())())))())())())()()()()())())())))())))()))))(())()(((((())((((()(())(())))()(((()()(()(()))()()()((((((()(())())()(()(()))()()(((())(()(()(())(()((()())((())()(())()())))))))))))()(())())))))())())())()())))())()))))()())(()))(()))))(()(())))((((()))))))))())())))())(())))))()()(((((()((()))))(())())))))))()(((())))()))(()))((()))))((((((()))()(())(((()))()()()()()((()()))(((()))((((()))((()))))))()(((())((())(())))())()((((((()()()))(((((()(()()(((()(()))()()(((()))(()())(()()))()()())()()()))(()))(()((((((()()((()()(((((()())(()))()()()(((())()(()((()(()))()((()()((()))()()((((()((())))()())(())))(()()()(()(((())())()()))))(()()())())()(((((()))()()())))()))((())())()()(()(())()(((((())))()))))))((())())))()(()))(())))(()(())(()))((((((()())((()((()((()))))(((()((((()()))())))()))()(()))((()((()(((((())())((()()()()(((()(()(()())))))))())))(())))))((((())))(()(())))))))))()(()()(())()))(()())()()()((()((()))))(((()(())))()))))((()())()((()(()))()(()()))(()()()((()()()()))())((()()))(())((()()))(()())(((()))())())()()()()))()()()(()()()()))))))()(((((((())((())((()()(((((()(()())()()()())())()(()((())((((((()))))((())))()()))))(())())))))()())))))())())(((()()()((()))(())())((())()(()))(())((())()))))()))((()()))(()(())(((()()))())))(())()))(())()()())(()(((()))))))))(((()()(()()()()()()())(())))(())))()())))))())()()())()()(()()((()((())((()())))))())()(())()(()()(()))((()())))())()))))())))(((((()()()())())(()()))(((()((()))))(((((()(((()((()())()(((((())())(((()())((((()))(()())(()(()(()()(((())(((()(())))()()))()())()))()(()()()(((()(())((()(()((()(())())))(((()(())(())()()())((()())(()(()()())))))()))))))())(())()())()))())((()(()(()))(((())))()())))))))()()(()()())((((()(()(()()))))()())))(()(()(()())))))(()))()(()))))((()))((()(())()(()))()))(((()())(((())))))())))()(((())(()()()((()()()(())(())(()()((())())(())))())(()((()(((()((()()((((()())()())()((()(()(()))(()(())()(()(()))())((((())))())())((()(()()(()(()(((((())()(())()())(((()))()))(()(((())))()((()(()(()()(()(((()(()))()(((())((()))()(())())())(()())())))))())()(()(()())(()(()((((()))()()()()(()))(()(((((()())(())())))((()(()))()))))))(()(()())()(()(())()()(()(((())())())())(())))()(((((()()))))()(()()())()()(((((()(()(()()())()))(()()))())(()))))()))())())(())()())(((())((()()(()())((()(((())())))))()()())()))))))())(((()))((((((((()))(()())()()()(()()))())(((())()()())))()(())()((((((())()))))())())()()()()(((()((())())))))))())(())))((()()()(()((()((()))))())()()))(((((())())((()(((()())))((()(()()((()()()()((()))((()(())))(()()()(()())((()())(())()))())((())((())(((()((((()))))(()))((())()())((())()))(()()()))())))))(())(())))((())(((()))()()))()())()(())()())()()(()))(()))(()))((())(()(()((()(())(())()())())))(((())(())()()(()(()))()(())))()(()()(()))(())())())(())())(((()()(((())()()())()()()))))()(())())))())))(()()())(()))()()))))))(()(()))(()))())(()()(()((((((())()())))(((((()((()()())(())(()))((())(()())()()))))(())(((()(((())(((()((()))))))))())())(())))))())))))(((()))))()())()((((()((((())(()())((())())(()(()))()()(()(((())(()(()))(((())((())))))(())())()()))))(()))())((())()(((()(()()))()((((())((((()))(((()()))((()(()))(())((()))()(()((())()()((()))(())())()))())(((())(()(((()()((()()((()(()(())))))(((())()((((())((())(()()((())(())((()()((()(()((()()))())()(())()))(())(()(())((())()(()())())())())(()(()()(()(((()))))()())((()()((((()(()(((()(()(((()((())(()()()(((()(())(((()()((((((()(((()()((()(())(()))()))(((()())()()(())(())()(()()()(()(())(()()))((((())()(())()(()())()()(()(()())))))())()))()(()()))()(()((())))((())(()(())())()())())()()()))())))())()())((())(()()))(()))(()))(()()())(()())))((()()((()))))()((())((((())(()))()(()))))(()((((()()()))()(((())())()))(()())))))(((())))()))(()()()())()(()(()))()()())()()((()())())))(()))())((())))))(())(()()())()(()))))()())()((())))(())()()()(())(())(()())(())(((())(()(()((((((()(()(())())((()((()())((()()()))(()(()))(())(()))))((())(()(())(())))(()()((()((()()(()))(()(((((())(())(()())))((()((((((((())))))(()())())((((((((()()))(((((((())()())()(()))(()())(((()))()(((((()(()())(()()())))))(()()())((()))((((())))(()))())(()))(())()()((())(((((((()((((()(()(((((()()(())))()())))()(()))))((()))))()())))))((((())((()))))()(())()())()((())(((()(())()))())))()()(()))(()())((()()))))()))()((())())())))(())()(()))()(())()()))()))((()))))((((((())((((())))))))()(()(((((()()))))((((())))())(()(()())()()))))(((()()(((()))((()(())))))())(()())())()(((()(()(())(()()))()())()())(()((((()(()()))))))())()((()(()()()())))))()))))()()(()))())))()()(()()((())))()(()(()))()()(())))()(()((()((()()()()())()())(()))))(((()))))))()((())(()((()))())((()(()))))))())()(()(())()))()))())(((()))()))(()(()(()))(()()((()(())(()))))()))(()()((((()(((()))(()))))(())()()((((()((((())((())(()((()(()(()()()()()(())((()))))))()))))(()()(())()(((())()))(((((()()((()((((())(((())()))((()())(()()()))()()(()(((()(())()))())((()()()()((()(()((((((()))()()((()((()()))(()((()()))()(())(())())(())((((()())))())(())(())(()(())))))()))()()(((()()((((((()(()))((()()(())()((((()(((())))()())(()))(()()(()))))))(((())))())())))()()())(()())))((((((()(()())())())))()))((((((()()()(()()())())((())((())))())())()))))))))(((())))(())())()))((((()))(())(()())(()))()(((()))()))())()))))())()(())()()((()))()())((())((()(((((()((()))(()))((()(())()()((())((()(())(()(()((((())()(((((())))())))(()()((()(()()()(()(((()(())(()((())(())()(()(()()(((((()))))(()))(((())(()())))()))()())((())))()((((()(())())()))))())())))())()()(()()(()())(()()))())()))())(())))())))()(((()()(())((()()((()()()()())(())((())(()))((())))(()())))))))(())()))))(())()(())(()))))()))(((()())))((())))((((())))()))())((()())((()())((())((()()))()((((()))()))(()(()(()((()(()))(()())))))(()))((((((()))(()))))(())((((()()))())()(())()((()())((()(()(((((())())()()()()()()(()))))))))(()()()((()()(()())(()))))(()()((((()(())(()()((()())))))((())(()(()(())()((()(((())))(())))()((()()(()(())(()(()()))()((()()()))((((()))))())))(()(()))((()()))))((()()()))((())()))())()))(()((()(((((()())((((()(()()(()())())()))(()()()())((()(()))())()())))((()))))))(((()()))()())())())(((()())(())(()(()))(()())))((()()()())()))))()))))))(()()))((()((())))(((',
         ]:
    print(f's = {s}')
    sol = Solution()
    r = sol.longestValidParentheses(s)
    print(f'r = {r}')
    print('===================')


