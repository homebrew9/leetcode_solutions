from typing import List
from sortedcontainers import SortedList

class Solution:
    def continuousSubarrays(self, nums: List[int]) -> int:
        N = len(nums)
        sl = SortedList()
        res = 0
        left = 0
        for right in range(N):
            sl.add(nums[right])
            # Important - as long as the end values of the SortedList differ
            # by more than 2, keep removing elements from nums from the left!!
            while left <= right and sl[-1] - sl[0] > 2:
                sl.remove(nums[left])
                left += 1
            res += right - left + 1
        return res

# Main section
for nums in [
               [5,4,2,4],
               [1,2,3],
               [2,3,4,3,3,2],
               [2,3,4,3,3,2,1],
               [5,4,4,4,4,2,4],
               [10,9,8,1,1],
               [1,1,1,1,1],
               [65,66,67,66,66,65,64,65,65,64],
               [85,48,16,42,84,20,71,41,82,21,7,57,86,40,50,52,81,22,47,35,2,46,63,57,63,83,33,86,8,87,44,59,32,47,2,15,37,22,100,43,41,59,81,57,57,29,32,2,1,94,66,52,36,61,81,49,53,78,28,90,30,99,66,57,63,11,36,32,64,62,40,64,87,54,37,76,31,59,60,57,47,20,21,47,3,54,69,49,60,69,28,83,83,47,83,3,62,35,38,39,14,31,4,73,84,29,48,62,60,79,85,59,25,86,67,64,79,98,4,48,34,71,44,7,62,39,36,52,47,2,27,78,20,49,16,10,58,74,83,64,96,35,14,70,18,98,81,5,3,56,67,99,39,37,87,61,10,87,32,68,6,31,72,52,80,39,81,12,2,6,6,63,83,50,55,87,46,88,26,66,39,40,46,99,99,46,71,29,89,77,70,36,14,11,21,25,56,52,6,35,86,42,45,2,37,74,55,95,99,19,53,34,61,81,29,75,76,15,77,46,60,15,46,38,49,47,6,33,46,43,17,15,99,57,54,2,94,43,43,41,80,23,89,97,95,90,50,46,74,93,53,96,51,80,89,49,54,2,19,29,5,69,81,71,60,46,93,95,67,26,91,94,53,69,64,43,100,45,1,27,22,15,56,10,45,99,60,82,33,60,74,34,11,11,89,62,86,71,25,43,25,78,96,26,5,80,81,98,2,30,19,24,10,9,94,32,89,7,93,47,57,71,30,36,56,48,88,73,61,41,77,62,83,79,35,37,77,43,6,54,3,61,62,42,20,37,9,78,5,85,73,41,77,76,53,77,39,77,58,52,61,50,98,30,81,21,79,54,41,73,54,77,30,45,67,4,52,11,1,32,16,83,11,66,42,88,3,11,30,94,32,1,72,11,98,49,70,47,57,100,80,88,25,100,11,63,34,36,11,59,9,44,99,68,54,86,30,72,12,87,45,7,65,10,1,73,95,46,35,18,30,32,62,50,52,13,98,94,88,50,41,33,83,32,65,43,69,11,91,21,32,19,42,26,7,97,31,44,90,74,45,94,47,79,91,2,24,32,51,29,79,22,81,79,73,79,45,33,11,67,44,63,98,41,35,52,48,81,35,3,60,67,60,17,79,39,9,19,35,92,34,56,36,9,21,94,88,58,28,36,15,64,85,61,92,94,49,61,4,60,67,82,67,6,21,88,55,73,16,48,41,84,5,66,14,7,76,4,51,48,7,80,54,18,47,90,41,84,55,41,53,49,96,76,25,41,72,58,42,66,55,8,54,18,60,86,98,44,75,61,63,77,42,44,22,78,13,78,94,2,80,30,54,25,66,86,46,49,59,69,77,92,64,46,2,30,92,91,21,83,97,47,21,39,86,7,23,58,63,11,10,48,34,94,94,37,81,37,24,48,68,100,78,6,36,20,62,52,92,53,38,86,73,22,87,20,22,42,65,24,13,65,81,44,37,8,31,32,54,78,26,75,86,40,56,74,17,73,91,1,30,82,72,52,91,55,24,79,44,32,13,49,81,94,72,28,57,24,86,54,42,2,58,93,17,78,73,71,91,9,77,35,27,11,30,58,92,19,3,43,73,58,60,82,99,42,64,16,2,96,17,13,99,53,60,38,55,40,16,10,32,93,75,89,91,90,18,36,95,56,47,16,69,54,90,27,31,14,80,9,85,62,53,87,43,44,78,34,53,84,35,47,12,28,70,50,12,36,76,30,62,4,4,54,78,93,54,3,54,68,100,100,75,63,11,59,24,6,97,82,43,89,32,60,16,5,92,25,88,59,7,9,43,57,66,27,36,14,45,74,62,4,57,77,67,26,29,97,20,43,95,34,50,80,28,18,91,8,47,47,12,25,80,41,38,15,40,87,13,90,69,19,81,43,9,54,31,26,24,3,30,100,96,79,74,86,51,96,32,94,80,14,77,61,98,64,69,83,61,14,17,95,85,91,85,39,13,52,24,38,21,41,64,95,61,32,70,92,91,74,51,67,85,96,21,81,9,4,45,2,11,13,70,73,93,10,90,2,39,72,60,21,62,13,17,61,16,87,46,61,64,34,83,10,41,65,37,7,93,68,50,61,99,37,67,9,87,37,10,63,12,18,43,96,97,64,77,98,38,28,59,18,97,4,90,46,23,99,55,14,77,42,91,23,79,83,5,98,67,37,45,53,21,1,77,91,19,50,94,16,83,72,96,99,94,97,53,52,55,12,26,18,59,20,57,88,33,47,10,100,29,26,26,57,91,48,48,12,88,100],
            ]:
    print(f'nums = {nums}')
    sol = Solution()
    r = sol.continuousSubarrays(nums)
    print(f'r = {r}')
    print('===================')

