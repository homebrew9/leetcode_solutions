from typing import List

class Solution:
    def nextGreaterElements(self, nums: List[int]) -> List[int]:
        size = len(nums)
        stack = list()
        res = [-1 for _ in range(size)]
        # Two passes from right to left of nums
        for _ in range(2):
            for i in range(size-1, -1, -1):
                if len(stack) == 0:
                    stack.append(i)
                elif nums[i] < nums[stack[-1]]:
                    res[i] = nums[stack[-1]]
                    stack.append(i)
                elif nums[i] >= nums[stack[-1]]:
                    while stack and nums[stack[-1]] <= nums[i]:
                        stack.pop()
                    # At this point, either stack is empty or its topmost
                    # index belongs to an element greater than nums[i]
                    if len(stack) == 0:
                        res[i] = -1
                        stack.append(i)
                    elif nums[i] < nums[stack[-1]]:
                        res[i] = nums[stack[-1]]
                        stack.append(i)
        return res

# Main section
for nums in [
               [1,2,1],
               [1,2,3,4,3],
               [3,8,4,1,2],
               [1,1,3,5,1,2,7],
               [98,24,-69,-63,79,4,37,79,8,10,49,-61,60,-55,-98,7,27,-51,100,-17,-90,29,-94,-90,15,-34,-21,-28,20,-95,-11,57,-74,-26,13,36,19,39,24,89,-20,-88,91,35,-10,-34,-85,-65,-84,62,-52,-42,64,19,-90,87,-24,-19,41,-34,81,-32,20,-100,30,62,53,84,-12,-7,-5,-22,64,-80,-75,25,10,34,-79,97,88,-92,90,54,29,42,-8,-85,8,60,-7,3,53,-87,29,31,58,-61,-22,-51,3,-98,11,7,91,55,-56,-34,80,15,-44,27,50,11,14,-56,19,-11,-25,-82,-18,12,-3,51,-27,-37,72,-28,-69,-89,26,-14,46,-95,-9,-48,-87,-79,-51,-83,2,-60,-36,-14,70,47,-89,69,-39,53,-67,-93,-83,-74,-56,-92,4,15,4,72,-27,42,83,-33,89,-8,-84,-10,29,72,-30,-5,30,65,66,10,43,-30,40,26,-22,-37,-4,91,61,70,86,86,-76,-41,25,-69,-74,-4,73,36,-54,31,-29,-16,-93,15,-42,30,31,11,-54,38,49,-35,53,68,33,-62,-6,-79,-4,25,51,26,54,3,-60,-9,82,87,-33,42,-18,-94,-40,87,71,73,-12,-27,-92,-64,25,-34,-5,63,-94,-62,-16,-98,-86,19,49,-29,70,23,78,35,-30,40,-91,-88,-49,12,-30,13,58,-99,-45,-96,60,83,-5,-18,-66,-61,-64,55,72,-4,44,78,48,31,-15,29,23,55,-89,76,56,-77,81,51,-94,14,6,-96,-42,-55,57,-50,100,-25,40,-34,-37,14,19,-28,0,99,13,7,84,-70,-55,54,-49,1,82,-9,-95,-16,34,-30,-16,-9,79,4,-8,-38,-98,57,-59,-46,-93,80,73,60,60,-7,14,58,9,-37,-1,-62,-67,-66,-100,-18,26,100,97,-48,-17,31,-57,90,-22,68,98,8,-33,5,70,-37,-9,-59,-42,-51,56,9,87,44,-30,18,31,69,68,-76,-76,78,72,54,-8,-69,96,45,-77,-33,46,-15,78,80,8,-27,74,35,-42,-94,60,-54,77,96,-35,-1,2,-21,2,-71,54,82,-24,-98,-52,79,-78,-44,-4,-89,-15,-63,54,-12,-57,-98,-9,-10,-41,52,22,-80,-91,75,43,-63,-44,-3,8,49,-86,45,-79,-49,-52,13,20,11,10,-50,-95,-66,-48,-68,-95,34,13,69,67,4,-30,80,-61,-83,-34,-3,36,60,100,59,-35,47,-63,-69,5,-28,-12,82,-38,88,-2,90,-17,-28,90,-90,-1,-34,-46,76,59,-16,-18,-55,-70,-41,-15,44,-32,-27,-28,-2],
            ]:
    print(f'nums = {nums}')
    sol = Solution()
    r = sol.nextGreaterElements(nums)
    print(f'r = {r}')
    print('================')

