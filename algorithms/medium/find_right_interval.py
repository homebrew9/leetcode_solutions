from typing import List

class Solution:
    def findRightInterval(self, intervals: List[List[int]]) -> List[int]:
        arr = sorted([[s, i] for i, (s, e) in enumerate(intervals)], key=lambda x: (x[0], x[1]))
        N = len(arr)
        res = list()
        for _, end in intervals:
            left, right = 0, N - 1
            while left <= right:
                mid = (left + right) // 2
                if arr[mid][0] >= end:
                    right = mid - 1
                else:
                    left = mid + 1
            res += [-1 if left >= N else arr[left][1]]
        return res

# Main section
for intervals in [
                    [[1,2]],
                    [[3,4],[2,3],[1,2]],
                    [[1,4],[2,3],[3,4]],
                    [[-512, 51],[22, 342],[24, 335],[542, 786],[-465, -172],[54, 498],[568, 982],[575, 589],[-436, 766],[601, 731],[603, 944],[605, 869],[-930, 582],[617, 752],[109, 703],[-397, 842],[-384, 418],[645, 951],[-888, -243],[-358, 203],[666, 843],[669, 914],[672, 744],[673, 962],[-860, -57],[-856, 360],[-339, 563],[178, 734],[188, 596],[700, 816],[-311, 544],[714, 903],[208, 501],[722, 936],[-812, 516],[-297, 369],[731, 849],[-804, -496],[-802, -20],[-794, -88],[231, 353],[745, 995],[233, 621],[-789, 885],[237, 812],[238, 685],[751, 792],[255, 756],[-759, -522],[782, 809],[789, 989],[-746, -551],[290, 402],[-213, 791],[-210, 217],[821, 922],[318, 472],[319, 948],[839, 911],[840, 953],[-695, -221],[-180, 419],[858, 874],[-164, 374],[863, 866],[354, 773],[-156, 623],[359, 894],[-143, -93],[883, 999],[-648, -288],[-646, -609],[894, 901],[898, 974],[-116, 895],[-115, -48],[-104, 482],[-92, -62],[-603, 878],[424, 557],[428, 627],[431, 475],[452, 919],[-569, -376],[970, 988],[470, 529],[-37, 668],[477, 746],[-546, 395],[481, 706],[997, 999],[-25, 728],[-22, 734],[-21, 332],[494, 626],[508, 820],[-3, 936]],
                 ]:
    print(f'intervals = {intervals}')
    sol = Solution()
    r = sol.findRightInterval(intervals)
    print(f'r = {r}')
    print('======================')


