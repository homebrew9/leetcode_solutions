from collections import defaultdict
class Solution:
    def longestSubstring(self, s: str, k: int) -> int:
        '''
           Sliding Window
           'abcxxxabc',    k = 3 => ans = 3   ; max_unique = 4, iterate from 1 to 4
           'abcxxxabcabc', k = 3 => ans = 12  ; max_unique = 4, iterate from 1 to 4
        '''
        N = len(s)
        max_unique = len(set(s))
        res = 0
        for curr_unique in range(1, max_unique + 1):
            hsh = defaultdict(int)
            i, j = 0, 0
            while j < N:
                hsh[s[j]] += 1
                while len(hsh) > curr_unique:
                    hsh[s[i]] -= 1
                    if hsh[s[i]] == 0:
                        del hsh[s[i]]
                    i += 1
                if all([v >= k for v in hsh.values()]):
                    res = max(res, j - i + 1)
                j += 1
        return res

# Main section
for s, k in [
               ('aaabb', 3),
               ('ababbc', 2),
               ('abcxxxabc', 3),
               ('abcxxxabcabc', 3),
               ('rhjakrpjkmiynkqsofamwineudrumdbgluwwfvjhyasaeknhfjqytyhcofadtebcvmiewsxcwgogyfcshdlwvbauajczlkaznyer', 3),
               ('tzrtfjalodkoucanwttrqkuryvysrrxjydqiltzstypfsviiyxxzhykkcigwxrmywmjsqlaspktmwvailhiqkkaqnqywzgbdfkujijzeliyerinxxylabfreysiaaqtxgjlfokybnaghplqhjedfuqjmyeccvyatkrtionrmsrylpbhuhsbeyumjpbnlnqyvyrkxxeeejoplkyuswwtlubmbsvnkwzmvaiowjoksvsruiqbrjfppestgdsaqvbghuxgvdqmuvyijbykuaqjbtopfqybgtelovxxfghoykxclllfuwjyoiqfdqhyczsbsbbymcvzulzonrwdlferyyflndvtzsyovsgtfrbqqmzxfmyorzuskfhvjjgbrmdxkblihtvqbdaokvebgvgdxltzufnlgncowlcnkgtgxmfvkydrtyeeavlulmphjmzdtrsxuitsktyoxmfdtivmpyzqljcuectrvsprnawprmbnvkckgnsrrcbamisjgyiibnkulzfxjxewetnxkdgeuifvwbwczmkawoqhfcbnnlsflatbpeohevhtwrqqhyeaidvmsmkashedyveguevxpeszysngwkbebifuceykugiapliwbemcyxonkcfjzupfnizchxadgcyeacomnfnfowoynvtexhuwqyrewmnurwffzlkylbfoswqausgoifoligmatetcdflzeuuuuyysyqxuvsybrfnoygsiobpqkypcqewutogbzgtkdgvwdnnatfmxugugoaehxctsnbavkmsiwmboqmsedsmxdkcgsjksgfztjfeabhtrilokxjmssortaocawexlvbfbootnlnvzukxtudckqvbwuvlnoxgquqbfniorzdrmceowawgejopdpnaspboodaahdyeioebxdyxelbcsyvfadjtvkpzkilnklddyytewkpaqwrpkemadegkiuthacopqcufvlpngtyyevvnnxgtgjuooh', 3),
               ('ufgqwsymvvfntpoemonhrzothticntnywtzmbgkflcjpkbknokdixaxvzviyasktyfzlaoxynaxscqixvqwqkgrdwtiuebrpxxxriuerxlilfxdyouzueyjhcifthbgmvcycefqrbouqgargrdzznknnskkztjmikmccbukcjittlhcedizdwezabehgsqoecjygullhknknqsodpsgcdrbrcmciuciszzrzmooiewqdvqktntqjlhxeaglmwqmgymybmlzorgaftrxepbgbwtbpsxidbyqucbqpkhjjzqawiexmumxlcssadalmqmhabmpvqulgocttbpupgtihjpwsbtvkfszoivnljcofvfsgzigffznuhwwbvlxerktouvkiyugvtpyqsogikzvcwpkzocktigszfhdosfpahkmtyneohabuzsfihkiegfimovqnaihdotcjfbnstjstcljevwxjynnpswuqfavoimkywtwkopnrrueoldwzldwzlprcrypnijlqzjxiazmjtofgcgutqphnokjtnexcjsdhcnqewqefoqrgcpdlnkuhzrscpedulfszwunyaduqdcrjqunrsndgehgbfvdlnrxcyhlsusrbsrpsqsmqkojmzzniwpdswuipsyxdvvcaeeideibjamrkqyfvkmithuunqvjkxlxlyiegcokslbtxfgmefttjkdxvkuejdzrkzosdxbcxgofidgqpzczvtzxsgzounhikqvuzciajwweuuxazeqegvsknbtjqystdvtgabisnwjbrjhmacgbgszgicpaoaeahqrvfvhqukwqeqvzdygyqdhupvszeotdegqgkbiaxxoqhecnpkfivbmcrwtepgwdyzynpwfnjmjznniikpojicuyytjjlqmoovqazeahtrugkvpxyhgbnghamdxrlwsyeviounffzrtseghqnpdonjabldwzenqqxxupgrllutxmxxdzraovrfdcwoporbwaxoptpjhshauwkbayjtcmmeyfjqnceszodjqflkuraufijnjipigoufhpumkafryljobctivnisciadnumjzhfdbfiomjdljkgpcrzsgzrgprssnwbwpjwfhquidxbagpzbfhivvsbzlmcpkenrsakzplgthltmuikqsvawoturjsxwluiunxxflwwcgfnndadsibinndftxaaclrzhfgtpyevctbgjopmkfeskkiravmolezevzverrsgsocssdynqjapjzzzeqhjxyyqlkzcdjmvxikecbdvblvwzemenjbspbalzidascevscqqmjzfjckzjncslrymkgsujvjmcshswkhrihkgbxvviafiskfpgjimixscidgzwjsbfwyqewdytfxgvtkqwbsczqzurprqhaeyldgfhpqpyyypehxjyporbbtvxzcqbprtfixpopthhpxogahkmcjinasfjrqxmrhyomkoifobfrzvhacevyhxqjnejkljehlrlfgqmhieolwthlgsqgfoisbunkrdahgggqxovclxerpqoyuvfmagqcytggywmszmglqyirpsiqrttsihlxxodnziiwmjknzrgywwsywejqadqdbynzhohzvybjunbkzxnpgjgnpxqwdynawqnbffmhftsslibiiztobpfxnglgsfdrvtnrriwptmjkqcdnrrrenxmbdllfojbrzlzcksarnisgqteqbowzfhitlhdqlkjokfsosoafjqljnrbmaethzjoangmlkyhvacunssehguxomyowwjjhlxpgvradysmhiguizkhnbdwscbkuuixizqthalmwttzhmblpsfmmusnjotiygzsnyzmxcapluoamfimpzctyyouqbqygdrmapgntkogbkubizwvyqfctvhmtgthjgyhoqrqlskkianhihmrlzdnqpcyzlrejrofefzsvhdkcrfrqmosmkhsdjszlfrhijyvejndgikcxmitmjiyiglfvbkyubcrhfuaorxvqrjovqhglmydgcahdmwpsposdxwdwyuslisikkqxdkuuhywipkwkiezqbvuunbzaoxtqbznzehltzfoxlogliovfhdfbfbjqgafhqbtsxymqybbmorpyhdeqopqsajethoivbxdilcvokjlvyetryjleqeyfbcokpdvigohhucsblazphvzkvammlvarfqsnfvglmlfacfboouwgbipcmggexbxexttvuofmgmqjnsktllyozqjujnisrjverfsdaailgltbcjlhkpdmgkfpsirevifuymatupwkfzqgzgqqlkdwzgbgcaahjfpgpebuivdkqfodzhnvcobcdehhqrefrzvvdunhoheafdmdbvtbgwvwiuumtwcjkveozyxucnrffcsucrzlmcyjzlaafmnanketoexjltdvepisexwklwleagmgeqepqlinatqdcnzrjudwsetzdugcasybxgnxdbixwvgqmgbwokowyfzapezgwzrdfgqvbrlejaekxhoimdlbosxdbqoiczqfvuxgqhqzgkvnjzpjsfsyelnjaghudipaanyhilgqlevavuachqeyqofbtdvqopjydykfaxpqytjxrbidgpvapzwkbrcuzaondhhkobzflewefrshlroepsjitjrlzkjiamhrdwgpdlpmhzwyqonodudwrpxlnyvclzknnixdoeqqydkevuczbpomvdoaileewkszwpdafpighgtvdiwfbskhapjrwvqmkvhotlkewqolbyvxlxidaeapyccpstcbguseclhqxqjutrgdkjgafzepgsakxbaunnhhommrlsdsdkdxwpivqhokohlzxprjeogpvhlsctydkhkmyvvhdqgkedtabwpafajlglgqktniapagueliwtbockeegyaushsusekjhildwbfcmkqyvreppazxpysayquvvxttwydghgslcilowhlodmqjzrljhslxssbsjjjuqseqncmujukrjwxhtdonbbzzsaweqfatqcsewmdvtqvazyzdvbfaanjxuyczjquqwcaoiuzhssewjoaestdnqedhskaiessivxfrzyuyykcgmzsiqiaserzjtqzhwydncmgxquonyxvrhuwazmopbexdzfebvnutmciiymtxdyanqtabhrmuorintfecjhiffkamesgsnzhnapzdoneugrrkofuomfsmbzabtyvixcwewdbdpuuoqwhctqqutcxvafrwhtbkygnjhoiufwohhkjuqbykiioehbqecgbmxxotpxzovnieacvshncxlmexxwvczqnfsbdrnfygcladtzmmpwcxlozkygjyyzxwdwlzzqdysvujwpwfignqpuyigwaxdrvkifuvlrimtdxcehkwnsuwhvatmoyxnfflgwxzpvxefawkyargkqshuehywxqqqmykxerwwowunodpieixrxaweadiwtyxwfiiwthgxjwntgusbbrvkqbcxzixrlwtwftqidzaiupvegdpfalnalgoyxjpijfiqihngvhwcvcerhgdhzlihmlmnhhrxybuqvsiihupijbfswuijozjtyvuuoczfzanxhxzprivpiamdtvewontkziecfyuyvafecrbnpgcmuvyqmfyqrjpgbepseeggjxouatxsbfgzbaqpvogwdcbsekwkvzaamdxurtphkabxazszwaxcnakqfkyhvxqbcowzvbpsnuwesnxhfcyvwoxezzryambvihqdmrxhadbbjwvpmngymirwzuzkescdbrxduuzypvceegqngjdbwgickudwcbzcburkyijphhpcuneqjnxsedaqwvcgtfgnyxgserelozegbtylmxfyjqkfasqvblzhlvqaehlzqthocxgvvrmzkxisgtloqmzxxqkxkkhbgfueneupmsmjzscgxnynkawbfnevcbcvuwiwtsmsnoazuixmmbamuippktwtcjnovrihfuccmywqqrlksxqzjwhyuhrxuxndyhtafvatbwdvhhfxnvelqvnrrjzlpnahanmkqwtwptwbsffidjtgflpujsgwatixwnrgnhvwdpomylrtnjokefronordyolutaicrtpnzwnnweydunquwmsvceyzukpuutookmvxyjbaxodyqyfonesnujmlyyneywmeyzxbzwjitmfifvbzrwwlchjlxltvfoezypworwbxhwnosmtyvcvqldlipstwyviopspiwnolpadwctpvovrbibhpjhkpfyzqpdrzavcxwtlclpmxwzozrvbflkirehiblfslboezuxpmyrfmflkzkkuvxnlsjuwdkfxvhkvzyecftrbsxybzazfllhxxogeyfquhskxpmivdvvtaqrbqqlfwxxxjuuktuhlcmdvxhqdvyzyseaetyeklpkhpztpqopffbwwdftqeiljfoelymgqmpjozgghuzlgurrvgundzqikczydwvgfhjummmvsusbktcqbpmhxodgaunggjfiyxpzrmkiqpcmlyeaarbjbfelojizqbxgqndxjpmpeqqdavnatnesaezktmvymxkncvcdpzcblsevaczztlmnzhlficvrmnmmnptxotkphcpglgiuxaccserorrnzkzmfrlbegcycnrkzjzxpchiqkeobzjyampmddubualmuftojmqxigtzsdwlipxgptksagskmenuccuptioyldeteypblawkslecnsxiywzonhspqpuylffbkzneycaspnnhlowcdkivqvmpcpndrdrkhdgvcmqratnxssfhlnkewropfsahwbyytwdiotmvzjkbqipvkhrvcxqacsodpuvtwnvyvvtathzlzvkzgstardndbjlfdmvpctfcstzmrpyrzblkruvgfmnjgyihhyiguvmmigvydoyazcjuoxwculnlbgingybnombncoexdamsgezmnmlowfguozrzrsgdnixxyijnoipbfsliqoxkppxxeqcylwbqgjsdebzenhnujrqgxjpqlouwajzmyacnmpxhcqomxazwqyehxordvfafjidjqnvaovfvjjtjqezopurqmnhdrsyeghlahutbmhhgiykffzlnuciewrcqtrpowyrthfyuxztwyjvzdgwjyufezcscnmitlangynyjdpkvnhxlrniemwwjdozmazdclsfebueagmxnqlrjdmhondyamixpxjegfyqzmsexssfvwartkyrxbyhdxpqiyizvwnmdyduqfhcpgcohlffcaaldmaqqiydytjhgiqcojjezqqvmbdwueepfdrcpnqakhrnbnnckihgvtpeajztxlawxxipkxflsfsxuxpayfxdiidgmetjsaisuanpchlfqzlhntodeesynkljualcgvixkpzfsgohldhanmgldnxpcwbxlryrzzvpfrsiassydzvhysypyborzyteyckzhckrrsxncabpurcsjhvxsltpzjvjttkkuzgmaxiuzlktyqbijokkiasqozgsqqlrworjzxgkqypyyuvxgjihcnsdfhxrvdduempveuzancfmkacyzekqqlzzvnqnxofjoivylximnfsqskmoibuhmkcxigosfgmmyzfnlcksljhnbgjlxurstwhcwwibexxpulohfdyekxcwxgfklvzkdkppjhefuftsltmnsokgkbwsizjfvfzfsjtkqrwkoakygsqrfxtmklblughialzsbzmqujytnnnaiypqthwrefbqgnehetzvsjimunqbknfsxclonmjtiqoofdzqueacbdxoxuhmthoepbrpsojusqpwfxvlnndlbceocrigjtuvadmvfqihkldnjkqaiwdvqosjmsifmlvjbyvrhugpqikdiabarmmmclihjcehibtfrvgrgbscetqdhgxuomhpkcptfvgwecthgpjjhxubwpkcqmkgkqaosbnbctvifhyovdlyehofenxmbjopqjbglpjsmiigdptueynrjifhsmcbckuzahlyrakabkhxsouwwkfcatfcouyuouozwiykxmzfhncdrpynqzsauwviuzmcmnhknligpqghpfvmntghqcurrffrrsidycyrzsrzpmkkttroouqpllccxczvitwfxfzsptmkbpszydrqdamcazkibuxecnxwcdtcvgjdibpbykrpkqbousulndezymrlrrrsgwglnnvtcdxavmkbgexzevuvynwlutnpmmcszuaxovccyimhgzzwefryexhidujvudocbobwzonsgophqonedgptayvklkszrcgezmtxhjygsacmmtcjlurfycqavapmobxathrtswnhpfiqihuwcchnhesrsouopoleunlgwkvddfntndkcvtorerlwznjhhagggqsizejstxbwktazgznvgdrvjjlnvscailbvgleinofybwnlhccfvrttiqbtgelukkjldlrfdtprqoaacfirofdjzjaenxnvkzqpimpstiddunobyspnlspdexdqtftozqexmcdratpbfbyabfynbobmzvhsztkoelcanptpgtgaialkcinudvtlqlawefqcztrueneugwmpfhkjtmjotcfzevbixdfsljxnyjmwgvgdrhbpuvbfkuxjfzskupldzzyesmfdwabiahpstpnkewwijvozqhjtfvfrztvvysupspkqrksghjllpvrvybtvismnkdtfngxxlesoptbeswedevwwlfzpgrgqxhwfzodbfnlsxcdqunukxjokkflyicwldnijjcovgizntnxljdpsrnsyxrxqterxiwfqovscvlutvevwxilswnmlmmwazqtnbeszgzuqscxsnogteqbkrlbbvjqcaprdoymyjdupgtwhpgkjqipdjtbwsvmlcdqzbcromqlrhcnbzwifuqlqbwujmvqlppnjrimpbwppzhsujwcvlxwihqobubtbmfhutpsaadhttxuksnsbcdzizwlxoicmkawoodjewzrkavvnazaroiajsubvwgumrsnyqxjpcatewnfvumbbjotwbchalxjreorygkyzrkcrqdlxmuiuhgsqxtpnzcizbwaqjdbdcrnvzrgimxfcmdctxnsnkfzmkcypxhucbfcahrboxjuzicjjwavjlrfnexjrtrolvdrmejwqbfhbkauurapxxwsgzijxqrcdlgfekgcqnbxlsjrpcuvgnpsgwlitmizvpygwvdcfgqbqkkmxzwzyycmvnmcbghdbnxsqdglqvjgjqxiaojkbvnluppuhebmgqqfzbcyobidzmnqjsvaovfupajlijduwvlejlpemkqrjlfsyliyvvqpaxyseccmubkmnfplbztwvlicadcbhfmwmflitmkhevtnthehtalpjdwqlpqipwwrzcfwtbrjmkrhobzcguousipxuywytqlvegsjgnzclcpvbfghefqzrrhvbiohciwfznuoubgndzffezcplxntusbmmjgfkcyuowwpbdshkkjosizejvnsycktjdidkskwqkakxniuwwjitwmdmefxugoqmevfijutqrtssccgdiddemcdtlnxvmiqmmcihkxbxvvcgcwemdbwntewnhcztfxzbajgbklgsusbzwmykrayzdnjliaevrjsnaotvuukxkrsiyhqdhwjeptoqccmoxtqjqttnfdwulqhkltnqbuhigscyenkfugwtyntxwtubgrjlzdmfddplmjmmigaoixrkslrjbanbkcjiwzwjllpljncxanpsyfrxkwromjhkitrqruurebetibzxxnccqijgogtoasmsnfpzxpuvmaccpkncuodmywqgibjtmcjopcmaeuquvtagvbuzqofeedwuhyfqspbiqqcixnkiclmzzytfilvpkzdjpeohlpowosbyffssbhyhjakevnnigsfbthbpqgdqsoswiqxeffrmaoohzetsrbmcsfvgrpzmdqpwozkjcmvfcelhktpbjvyvmesmjhyarnmazimrhfmpuynxuwiociqdkcwvnjgapveajushfomtmafwgpoqbitvahupxachptqeprmwitedfskuhdevyzzpxzktsynzpcdpkjtggnbriowlxjscahqdquxemukymqijokyjxhljswdqlqcwpxmlezbzjhwhoxhdwamicsnjkviuiwugxdskggkrrvtvwdcrncvnfzsbfwstlvfpdyiboeuhavzaepschbyxwpclmriuhodcjjiygdvqxbwaexoghvsijejcvnnawirqjvrdotkfkjyjglaheplfjwkvbgflldtmppulnynqwyqbpkfoggburykvhgmdonwagnyxepqmiegypigtyssszqnsrfwyivauuhovrfcudehogkdbkcnktlzyivhumrkwspiclxkeqjkulubueggqmtlijhhjuzxslqkfhvthdamjvvaekztbsybiunlanoxbjzrszaaszzbxyqlkjujerlracmctrqansvlqwqfogojrhiezcpvoqhriouixsdsmyzdwuudxiczqeauzguoyjiosiesufesrravoumilxlioqlfgintfvebuvufntiydybjurvwrcgemelhdxfnyrmbyfnsomxagmglxezronexopvvepdakqlyjvbrylqjjjtragjfmzhiukmrmytndhkfvxnoflfvcigebixniwdigjjemujeoaflicanlokghnsqrmoojlwihpqafqgpwtvpdujjedljblhvbnvwypqszvlqjvgzrkwlwmyrswryxnebmdbyihjwpasbhpcpktrdfeehdymwnbiblwqfgtvcelovcbuzilmdslxlssdwlctjmidvzuognzrnwlxoxivdowgvuvnyikwadnieqahfnanuepmqzbfceuywqtizogqbupapghmwlzklvsvebchsrwbnihoeryudkofytowwuypysvaamhlylocdzlgrwwukddzujydbbnrfqpzezufcgdnttrwkysaaiykbwsfzjvipklwncrdrkdxkzfqwviushkxkumxectdigtomfdusgwfdcdevqqqwlfjyshlyhoueexzftpgnjzyxwhyhxvhubkhcuksgelzohgllmebuohlrukpjcxgxsaqwbqszxogecpubpeujcoizmblwrqzzqdyryhwsxintlzqfshobzvuclbgrywgcryrlsnvnwbrudxtquletpbfthrmrfnwzzbtotbkmnjzysavzlvnhmusruwwsyrbdnmguvnmacghpnyepmtrtkpvaaqsevqyjtpcekmqnqcllwflkfiuofbqqoxaznmyhzwhvtfdpcbgvsdmcinzznzahkpplbsjkulcfqttegyfwwtgkbeirhtpeacubwvvuzwcudispxxvfmzpeyzvznpeglhxuwxhmrimdpvszwrwftgdbvwojnyllxxqpoldlrgrukqezvfuhbcqwzdjmqwlcmxtwmvkbyrxqnyfgtatypyotlzkkdxttgfrmekiwvyjvffcvyjwdukhbokhepewlgzmicixuuoilpblddnojklikxrvpukqlsohcghdpdnflyagsgqjvceswdjvuhrcdkpfiyxcafwttjhnsboztkgfsniczxtiwutjhzfvwuxbsutpddurzaevzswdhocthexrgqlffuvcumggoflxeggdkjyzsdmhcvvsdehdhgmbkmhmpvmkjlwecfnpjqihtjgpbwfcnesdafkbbrjvvlxyiblxolfkntmlammriaczqwaovzczgpwusksjysppktxzcuhofoscewyuqxihvqmcoikuquazdvrierrkyscreaaabcttpurbhmqpnzqlsbcoofuvxhzhhykachetnwar', 9),
            ]:
    print(f's, k = {s}, {k}')
    sol = Solution()
    r = sol.longestSubstring(s, k)
    print(f'r = {r}')
    print('===================')


