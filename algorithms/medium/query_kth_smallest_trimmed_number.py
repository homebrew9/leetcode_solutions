from typing import List
from collections import defaultdict

class Solution:
    def smallestTrimmedNumbers(self, nums: List[str], queries: List[List[int]]) -> List[int]:
        def counting_sort(arr, pv):
            #print('=====')
            if pv in self.hsh:
                return self.hsh[pv]
            K = 10
            counts = [0] * K
            for elem, ind in arr:
                digit = elem[-pv]
                counts[int(digit)] += 1
            #print(counts)
            starting_index = 0
            for i, v in enumerate(counts):
                counts[i] = starting_index
                starting_index += v
            #print(counts)
            sorted_lst = [None] * len(arr)
            for elem, ind in arr:
                digit = elem[-pv]
                sorted_lst[counts[int(digit)]] = (elem, ind)
                counts[int(digit)] += 1
            self.hsh[pv] = sorted_lst
            return sorted_lst

        def radix_sort(arr, trim):
            #max_length = len(arr[0])
            place_val = 1
            arr = [(v, i) for i, v in enumerate(arr)]
            #while place_val <= max_length:
            while place_val <= trim:
                arr = counting_sort(arr, place_val)
                #print(arr)
                place_val += 1
            return arr
        
        self.hsh = defaultdict(list)
        res = list()
        for k, trim in queries:
            arr = nums[:]
            lst = radix_sort(arr, trim)
            res += [lst[k-1][1]]
        return res

# Main section
for nums, queries in [
                        (['102','473','251','814'], [[1,1],[2,3],[4,2],[1,2]]),
                        (['24','37','96','04'], [[2,1],[2,2]]),
                        (['242167185558041968677241544739418613342644382905277415747334686485704736226155350467127801954','625820089334839761015775491304544885660619809583066576413574095759305031975133183346173220672','682831870413635204210786157477412248834237204236891937504350537587059015083830520407030857033','086628747429625214503181539181080037348126576403443896518689670695633768494997544802107757432','480734188198169978646988457266115138537038384328957175254408448332495427657089820555656446388','611518928985805409538363634999526828113820213200994234235911965527728778287021336289138113382','608949942124130004623857889117391316878116295633554066809419690279037558220848865464405252466','504605643473292908963966240042845008418538938419577097614109198540854703256834131536340121594','486007932452797238303729274163028289944095515407688910245303089552533997644290005542903055970','271624705694937625538604977207945654142908766919968838599369965522244987949938780033946120451','115542996596491273770969977093027108913390479089099499698179228027541188859877976221125995055','914884670479597666889868326191557102457060510433440958444523311093190711707431789344953099578','434563858742514650942590973720008938986020024922023442949170027862760716233175025781427714731','851627915017296251880348274664228157324781617737375837137106867491408732038752959466321886867','999181593776600899542871764358243971628901601391319742044932037117527183444753413342952188010','484096759861636563616531072206370190164667337115619672278425971904032253702831728230819324381','724685500529084497909835561965996404275660882694842949634500898758061525092846238704133109704','723160889849930119536678471002800039002330024764005827849052806088357675188301108532106525443','769435604780805179990387842085040310688450636671929488421817138150964286860436802376241937773','253945588983301539856132011774955148929625444189739839988750037990464058735758106118128472730','849062002878898369537340441868366741421194812608596847209237523656403073287485191119554515629','432617586621223604983352527014279822730638131894420500321603313511146018104014508075875672332','330883120549564597826217820773875091743633971209401192975090430901504559943114081849692736525','373127085839270478585956730965383582665821239779074641836480603891573517645720384878876494134','596500082353346538232509299713130695581415800715805217705500301179683962472673008581339218363','206183373997833265264942880544950204993332528065525398309825553706145332512665831894703499030','975123815990592623752631276777729769410185276014197221663948573827670425939156672325555770181','235856401558054413794753150561684292056511366013226872251128241740099190092423012695989327596','153700342323523430174805034961081088507483263059321509323564100372456272204920696547963511299','997052791683569117437480938586485779591516261924230576977939243496936120125577075146640140078','245908738215278894974101054839005516672417497706561822316112945135557539644526093272071476427','170820712844154489637280052032109201139306305369274529212399454175359135069697444000401909751','168762388366918443495204263369734111605458778355475125055073328001998885939863783202787164913','433642982793250658461821774570044876141515635452220367869913955120213890535021054954606121131','382715568988979606728729127857728931111770223522896258681890159265421188892292818288298607330','661581165017008540526685277414787303426972757313098694911959010714209313270187195343666866561','631623862430953388157052142944878508960294414691815010546843134363784997437656562119325373276','699650752457288726760344905847215087950600949492189176561904106129076345069586327681878131907','124965340461998291791295363261726918118424322555541692922588051977194727814987066882536763137','624245507944036209620050255762210584355552045456061918607744881458091175666854136131627398835','943029715260804296753939026777546327621980749929666869700577017627724873566786748490660669786','675021517220035170488408932278534193069944139394002418737140645342688202768034551297977625865','759497607476508827984120799000615673168107904120920863587355832970510242597300637970063368921','795684402626010912011996722540767294881615762202354721084127260773122662103332321038021759224','128581636979531772228105654047695799561523483630071747274776366196464798069777091175932907454','255360647065816113332216164873190190362135943169406273647869897992716241393794191270621388092','863229644338217783741154255484477196660116194550270083980281941686051894257569704342760157875','855745849853596242034062311857095758947966809330911341983230944168464718641552104334740305101','322376205826035421232788267854545935713962538897571554877126305640928461676223858420531868376','319084108402640824911870586441047004154577185346395136645689977376645848247372536854883999856','399743109705626377163037642376216978629404846249426178034698626170906432233034344773492852245','086892119872047133195031896581018160922874212656325473385330825297344201642703441557343034458','239449462366592925383590072960984360780188518128196497738675494539429693920149900571419233187','748313376898068928361982545137224507110966991726202446616945404522413901950389737936538796794','038002508655183060965506013164045514846359114317600236934966457547327459847026826455682288815','379231569010550107720150912060408779264595223955355687336918321436359868372606726550698111832','488222678387148008513694725004729518050579639561559789780693118603833123997702314137693620223','386232378688385907544819179903290667933962820995444572624264356182261196957869449508900882087','847164813486821345830733001318437440310799691554821964923307838771795694930018589525082951515','573542518571817097241365890835671333635711333980901943212574743204973710782874725955296836697','966603111327195345498502693927857739462366084153978477653484260829219800600127757543278754086','184885541559067416747533616383296241467979607287406945864667147924848646767467141455269756834','041275899483876256907632432329710240619452268139410743293674414137116747590722590941983573776','225862316612474304530173520321454209643442105028833354461181225274961502303547812646212974393','272568910916963930934677258920167417440194275842952609541201107460324713854129233422727006124','708591358372676743427552811100216286608826180468351026761643935398569526830569032753759813065','028374742323790887395243485882547997227163013352682396557088005849367602049777862985034276923','024660357600308726297860780465266124577763681761107676869859181050453220780881884793516694912','518466649599915536949301962253256949531223567190705399534675350511812865784648896072289429641','355544734917954914383714461329126873049964465430499003162384474188396751955387153013306618355','538481230582134194075617989090498573273807492121764441305655525166900475462595931209279388637','807530968917979431524709148682026507915637275626625839449523407781238846241262375424361260549','571588584781314760378749121978298404334443292762075884343802797958562596145233268837520404694','733193885365171971597755834977173981904463812385500325095211773731533043991814051039766213048','830918694984767559245307423977359559983910332289918807089381949978538800669131668992088928115','243018383756134536524835468081575091471224695004888199635905920635012864513417578472989750833','247392500673004899874868504934049861801797338683713172980513805069807466937311297614128989916','126622829452896252285138496731870716368990209170417715305548674843371562745874380836885776479','584095402843064822255459997198455150534678899462202075682992718360231205226356782439882587498','735849644388018261585551184381027723911135267885590758578449267861231227720208884541348184866','380500476933162802532315422515648802230606840784254902827849897949060611949762601298377827413','905155669291069013836251974393727461893949005659287456480845829403829276634630165840840508508','973927138169972104495576541634494374375583345982537046947488667856625715459891255856503478313','443158197646444570854084219115525636151420729824290770247205224869404059993674979399059791020','592666254017920358673081419232922889585701217922127005437022923003588141466162652264556142697','818277617979379882302107938015742962003971730345378920163102333531720453888057875880433000391','331254210467539289180784747099184807669367822827563293398676671791855350199535647103042186220','360117445469338288159839620113977621328681212679531158342707278053585353483685003698016467446','861612593401710984926558901888781294726685795883399675714191520275820800399908651027599191862','265522197009694923908123392776144985965010755155385002901560904257196961379835811323124512501','921216810115681108979171287240719021137529979120881201542765058191894287070249519324817816007'], [[64,9],[59,13],[25,49],[14,82],[17,69],[42,50],[40,19],[52,34],[42,73],[42,53],[87,43],[2,37],[7,30],[25,87],[89,65],[88,2],[7,24],[61,13],[63,81],[23,35],[84,20],[70,42],[47,45],[11,75],[85,64],[78,14],[23,71],[38,81],[12,70],[60,50],[63,81],[8,41],[72,12],[88,73],[43,56],[79,19],[30,63],[61,76],[42,14],[37,66],[55,66],[49,58],[31,30],[85,2],[18,48],[52,82],[20,76],[64,9],[10,69],[18,59],[60,77],[85,76],[40,74],[62,48],[3,23],[13,1],[10,2],[31,93],[7,75],[27,2],[62,30],[51,39],[32,87],[78,47],[20,3],[17,13],[24,32],[6,69],[33,3],[82,24],[44,78],[86,53],[76,87],[76,20],[42,13],[13,41],[11,7],[12,35],[83,37],[55,54],[10,1],[1,45],[67,92],[76,62],[67,26],[32,13],[35,25],[69,68],[45,75],[57,28],[52,66]]),
                        (['0757635647791827171628342843080677113328626871786681912293643260379070105059093400296764558','7475283366383019896080986176420243569447879789122676164801675140470227789460590334714822440','8980700502981960592018830297924584677427908063834430670748199140524246143263972784668847126','8968614366137894414479729441868877993702905773926327797327059003161129841334806983113376710','4528639811895416646956472893642994939788247464867091813425092652721888122181044088989574841','8187852517834531029928351378370367183805866714319932440959493796725049766888873783770176653','7658705945496376924856578579921352528960922693554020143979617285682953500156999518722463269','5740820638755934360771425947863977974058778114967437327215262615672815097284367463471241609','3260103602729518359757571404891557997535083092771556538733451166394297389808361036366591717','2439318275220264157565028274372221665192079157993298712493305399516811937528015104150378754','4290367200852266035481334147650558011679233033613396577046150691969795055881241941676549551','1982948899972492623151658274991517547567693188844482075997986406315019871264268884877338301','5865017918041436072528125213663146732867450142904910863427243132260657496658437536465334419','7573572865409001264219991064014231066695091085311353306913110436077791794510346055987856906','2234075318530088709339042892770189986752688969270410107641074042535661016039871656629778489','0544030971377904190331888867065740797449093021230269847218800486412184351223658569601801029','4397338019733145106791394701608070133300471395354383134267453917327386441334668824137757729','9384495492576261320589507910620694507986787859043523036650711632944777202964575739199748624','6790064711005438389094576557252731622158912941061183380070644652441805207704997582073401098','5259558860339773141510660958215868895389098135171600195331769097349670640319246232656390329','9612405474058153591869420227613683973463899372630762061748446629693790499614959881757336277','0668137219849384796022888608579256028587490143081994074036133070207306290286759506050530913','3785894781174942061495931364055722600635877098497150466966184994169070535508809316278632062','9148650460578589578173720625020016530840235154720215678795511477515689858309203890631631600','9542119929877206880133964252506577634994723581785715428040603782375685486843100267656038665','2172480169615279377773391705576158603267998672374175018372438459256875174758467055442518182','4304400221263044426883009237973819992629511239779204040871354137120404852919236202454194037','5104313253664728568595031237923775477221725631908911593981993248830865479529982023903409579','7782759186837811772168008094824560627441156934383994203809113865633525059861830412922897506','5012640821494851978414086223085056786276805612256979693076924836164738865761659603415857304','1483329909247845120939966637408501972550986291331403093918290877966733568371854251838245171','4013860685160051463283614157788408863602432390039233110500980692179381569135688021556325567','2291537648009618348468478498153200573069883111027591533724560456363448975331036703881333072','8201081819388131342972985198060351162876638971301407352517035705684179117074032544164895511','5077017999566322377458668514397904832639741643487628996518038370790814556685586188211953220','4450096002302014061442664332528378446229173512753685289660757095551057328178939820938495140','7562075384877992644569167947942612796812984414710460888728358460556163476314919495531616193','4785640411766530220898447103435238818972487738017010249889241986190471814850257804536820019','6651405918210609043498831790056519253412801318416654490554242413081902346190235514740257951','9179432650584823014773183376277996669749321520970764810400593421459748843911212731787463820','9470390386586261408067929871274644636661475195337075069282482750043990477137367086620505091','9195907320606476827566395425123794781392924898502535905180897136611272972118068049781826676','2932967810188939991719286501092333946892649283362279526387462054076855995673239039248589270','0096746091402480559277968964649061373905867871756572402962025702533979973822459898076740937','5144443074735754316261558118357318759732892836973220952068708014856704905189072606319139982','7888134689124586524640199604585120178066246973176744470453399774296688930629329747744558190','7728948987336322185116063484580529961117099851878095961506788926475987299949228892180235917','5613717718310251220715747645128427321366544248720601780257072168958292412980883846020065191','9194027221303628137052275368327567382357297797053432242425119307071895071512772530587564212','9831990249118849160592293870989904266795378419102518065064563873634000352468265765797770361','8727924880520515652123698585063596179335816431543677307208850337211415361346374319851575088','1533325540557357251476356883887074956621413461799187120647995090213473167344314815568414201','8861484747272041778904948443968018459843171656720338895801734497866523535230084980119815602','8210305867901719643989203337365456438316702289327434369372941080777403087318505870685417288','8129647192904382708550197158341271769924980206807194756558045280001824133938117377296166229','9056352969568843902638064339987534228629799901465129390471325035744911895390871196504780708','4341877206354946865634200988068725176158799317085408508506064398944032016633051759936019501','8705054229869587195635329364516057345984174852455175441737625471414930367262617920343531149','3509474014250297129143805529214788008363797106663887609209699827318164349760125247406506254','2675138522673883593143798793592096474341428531328595685416288546233609394972258621422077037','5234725649429155697213739838596858217994987220611825584721761078319977720463728599213976451','2418857113079349401277280090704244205489860834707855759814855401492784060897083076205896247','2176216322603560887498144443709153047559649806788974064999587869584160809503122177986250656','2343410395272588900351698914436000994267469468606701792693124071863015112839142785608829096','5238582328493755435905198692868680903986221359820913014611349274047448844947449940204538425','0489529668068614878081296479757722010758182800933129963964233026286871268971102842264395363','7011818066369161095647743725503503883070516965183878435521592396441107362189391737774358182','3233948414461896024858005064019381443380891935930609676153431178243336164154285478913372287','7307869362659566750891640581396123410958635536942802678857053205347905053119100454883961163','6520760725862733862819238396476050749604757382522908117898289472283763074282538026902611665','0353287924185252622296968429997851059988111255747159543590622003600253026452672249116912078','4229060912882333598038234576544980260549175724470070192299343386841124679794139062318472455','4717902866592351492532336274631882920998564104585457393455429934886187737473704758432857834','3274877776593187643670538034203641455640152292398948866010694230300290443085956682497231514','0858662213926786043991394752322646926990898038513068678707516289318666900819585142165057020','3294558370607909043699756642959291671928055759548581774801629938413873451684610918087806170','1905718091540883122515605847535639835069599004005680064863186491849762903358301791480242431','7095759148895927637963503866959285873921917902873946640094133732070854136158378042019879733','5607259856263814202791966187665898478270831328335149867393801174455991445085655054012637523','2538956430517294136514178147706110108842399825259129742050668692675715115040411010804632566','5281893936208778551184876049628559211349977008068089381459964174936610779254914578224635990','7114176234087237540576276722433556441813267081812966388712533747573697496009534853521453027','9105910521602001288722532114360408080008529668599452099120221827311335923088095422706005899','9531336927232068080995804395080628088228361634668983685498774429698066560150005619053691654','5989030981937575777872202879022422673778963443230195046704503017639785304637086140782244222','9869720760695624897787094535851919211155242654650125255617442073767201246954429586862971420','0742839323136462038086746926320285367469049702001047808304974778598976634838336881286319816','6640471185188306982376231336285383214708396264785851452836519363152518652596326499927075883','0121992475799021847096660487465353953785175657781199249205486684809019554761183750402975198','4293815969016284749837924454612248254767327581047055367609599468359739834654896502035236767','8477467340723939846332612306841369315060751915216842630650790386098194348096955800924091872','7826467619174988638565181371601555917656828728419007700478428131542591358468232462594587685'], [[24,60],[86,45],[46,77],[24,66],[30,49],[15,57],[25,70],[72,54],[17,61],[78,78],[34,91],[44,1],[65,71],[28,19],[36,89],[89,4],[15,78],[69,1],[54,52],[40,25],[67,55],[71,76],[4,76],[10,13],[11,49],[44,3],[23,60],[24,2],[45,86],[8,91],[82,64],[61,40],[22,50],[50,75],[91,75],[41,43],[87,1],[25,14],[15,19],[19,71],[48,7],[78,33],[8,9],[50,47],[11,56],[75,72],[7,61],[84,51],[58,59],[58,61],[51,13],[31,16],[29,85],[33,3],[76,9],[62,70],[21,57],[22,65],[24,65],[4,62],[18,30],[60,81],[80,39],[54,2],[11,88],[34,89],[8,82],[85,5],[72,79],[20,3],[47,50],[80,27],[54,42],[40,34],[53,21],[6,13],[85,46],[70,8],[84,68],[85,16],[5,47],[33,35],[84,1],[49,43],[42,72],[10,77],[22,51],[27,24],[23,75],[64,22],[55,4],[70,3],[4,61]]),
                     ]:
    print(f'nums, queries = {nums}, {queries}')
    sol = Solution()
    r = sol.smallestTrimmedNumbers(nums, queries)
    print(f'r = {r}')
    print('=========================')


